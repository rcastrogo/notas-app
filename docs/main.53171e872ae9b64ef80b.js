!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);let r={};!function(e,t){var n=e.Pol={apply:function e(t,n,r){if(r&&e(t,r),t&&n&&"object"==typeof n)for(var i in n)"object"==typeof n[i]?e(t[i],n[i]):t[i]=n[i];return t}};!function(e){e.apply(e,{toArray:function(e){return Array.prototype.slice.call(e)},isNull:function(e){return null===e},isArray:function(e){return Array.isArray(e)},isString:function(e){return"string"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e},isFunction:function(e){return"function"==typeof e},isObject:function(e){return e&&"object"==typeof e},clone:function(t){return e.isArray(t)?t.slice(0):e.isObject(t)&&t.clone?t.clone():e.isObject(t)?Object.keys(t).reduce((function(n,r){return n[r]=e.clone(t[r]),n}),{}):t},join:function(e,t,n){return e.reduce((function(e,n){return e.append(n[t||"id"])}),[]).join(void 0===n?"-":n||"")},stringBuilder:function(e){return{value:e||"",append:function(e){return this.value=this.value+e,this},appendLine:function(e){return this.value=this.value+(e||"")+"\n",this}}},build:function(t,r){let i=e.isString(r)?{innerHTML:r}:r;return n.apply(document.createElement(t),i)},$:function(t,n){return"string"==typeof t?document.getElementById(t)||e.toArray((n||document).querySelectorAll(t)||[]):t}})}(n),function(e){e.apply(String,{stringBuilder:e.stringBuilder,leftPad:function(e,t,n){var r=""+e;for(null!=n&&""!==n||(n=" ");r.length<t;)r=n+r;return r},trimValues:function(e){return e.map((function(e){return e.trim()}))}}),e.apply(String.prototype,{replaceAll:function(e,t){return this.split(e).join(t)},repeat:String.prototype.repeat||function(e){return new Array(e+1).join(this)},contains:String.prototype.includes||function(e,t){return this.indexOf(e)>=(t||0)},startsWith:String.prototype.startsWith||function(e){return 0==this.indexOf(e)},toFloat:function(){return this.trim().replaceAll(".","").replaceAll(",",".")},fixDate:function(e){return this.split(e||" ")[0]},fixTime:function(e){return this.split(e||" ")[1]},fixYear:function(){return this.fixDate().split("/")[2]},trimSeconds:function(){return this.split(":")[0]+":"+this.split(":")[1]},paddingLeft:function(e){return(e+this).slice(-e.length)},format:function(){var t=arguments,n=t[t.length-1]||self;return this.replace(/\{(\d+|[^{]+)\}/g,(function(r,i){if(i.indexOf("#")>0){let e=i.split("#"),n=t[e[0]],r=e[1];return(n+"").paddingLeft(r)}if(i.indexOf(":")>0){var o=i.split(":");return o[0]=e.templates.getValue(o[0],n),o[1]=e.templates.getValue(o[1],n),o[0](o[1],n,o.slice(2))}return/^\d+$/.test(i)?t[i]:void 0===n[i]?e.templates.getValue(i,n):n[i]}))}})}(n),function(e){e.apply(Array.prototype,{remove:function(e){var t=this.indexOf(e);return-1!=t&&this.splice(t,1),this},add:function(e){return this.push(e),e},append:function(e){return this.push(e),this},item:function(e,t,n){return 1==arguments?this.filter((function(t){return t.id==e||t._id==e}))[0]||n:this.filter((function(n){return n[e]==t}))[0]||n},contains:function(e,t){return this.item(e,t)},lastItem:function(){return this[this.length-1]},select:function(e){return this.map(e)},where:function(t){return e.isFunction(t)?this.filter(t):e.isObject(t)?this.filter(new Function("a",Object.keys(t).reduce((function(n,r,i){return n+(i>0?" && ":"")+((o=t[r])instanceof RegExp?"{1}.test(a.{0})".format(r,o):e.isString(o)?"a.{0} === '{1}'".format(r,o):"a.{0} === {1}".format(r,o));var o}),"return "))):this},sortBy:function(e,t){var n=[],r=e.split(",").map((function(e,t){var r=e.split(" ");return n[t]=r[1]&&"DESC"==r[1].toUpperCase()?-1:1,r[0]}));return n[0]=t?-1:1,this.sort((function(e,t){var i=0,o=function(e,t){var a=e[r[i]],s=t[r[i]];return a<s?-1*n[i]:a>s?1*n[i]:++i<r.length?o(e,t):0};return o(e,t)})),this},orderBy:function(t){var n=t;return e.isString(t)&&(n=function(e){return e[t]}),this.map((function(e){return e})).sort((function(e,t){var r=n(e),i=n(t);return r<i?-1:r>i?1:0}))},distinct:function(t){var n=t;e.isString(t)&&(n=function(e){return e[t]});var r=[];return this.forEach((function(e){var t=n(e);-1==r.indexOf(t)&&r.push(t)})),r},groupBy:function(e){return this.reduce((function(t,n){var r=n[e];return(t[r]=t[r]||[]).push(n),t}),{})},toDictionary:function(e,t){return this.reduce((function(n,r){return n[r[e]]=t?r[t]:r,n}),{})}})}(n),function(e){function t(e,n){return e.split(/\.|\[|\]/).reduce((function(e,n){if(""===n)return e;if("this"===n)return e;let r=e[n];return void 0===r&&e.outerScope&&(r=t(n,e.outerScope)),void 0===r?e===self?"":self:r}),n||self)}function r(e,n){return e.replace(/{([^{]+)?}/g,(function(e,r){if(r.indexOf(":")>0){var i=r.split(":");return i[0]=t(i[0],n),i[1]=t(i[1],n),i[1](i[0],n)}var o=t(r,n);return"function"==typeof o?o(n):o}))}function i(o,a){var s=e.$(o),c=e.$("[xfor]",s),l=c.reduce((t,n)=>t.concat(e.$("[xbind]",n)),[...c]),u=e.$("[xbind]",s).filter(e=>!l.includes(e));return s.attributes.xbind&&u.push(s),u.forEach((function(n){String.trimValues(n.attributes.xbind.value.split(";")).forEach((function(i){if(e.toArray(n.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach(e=>{e.textContent=r(e.textContent,a)}),""!==i){var o=String.trimValues(i.split(":")),s=String.trimValues(o[1].split(/\s|\,/)),c=t(s[0],a);if("function"==typeof c){var l=s.slice(1).reduce((function(e,n){return e.push("@"==n.charAt(0)?t(n.slice(1),a):n),e}),[a,n]);c=c.apply(a,l)}else if(s[1]){var u=t(s[1],a);try{l=s.slice(2).reduce((function(e,n){return e.push("@"==n.charAt(0)?t(n.slice(1),a):n),e}),[c,a,n]);c=u.apply(a,l)}catch(e){console.log(e),c=e.message}}n[o[0]]=c}}))})),c.map(e=>{let[r,o]=String.trimValues(e.attributes.xfor.value.split(" in ")),s=t(o,a);return s&&s!=window&&s.map((t,o)=>{let s={index:o,outerScope:a};s[r]=n.clone(t);let c=i(e.cloneNode(!0),s);e.parentNode.insertBefore(c,e)}),e}).forEach(e=>e.parentNode.removeChild(e)),o}e.templates={getValue:t,merge:r,execute:function(t,n,r){var o=e.$(t),a=n.reduce((function(e,t,n){var a={index:n,data:t,node:i(o.cloneNode(!0),t)};return e.nodes.push(a),r||e.html.push(a.node.outerHTML.replace(/xbind="[^"]*"/g,"")),e}),{nodes:[],html:[]});return r?a.nodes:a.html.join("")},fill:i}}(n),function(e){e.ajax={},e.apply(e.ajax,{get:function(e,t){return new Promise((n,r)=>{var i=this.createXMLHttpRequest();i.open("GET",e,!0),t&&t(i),i.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),i.setRequestHeader("Cache-Control","no-cache"),i.onreadystatechange=function(){4==i.readyState&&n(i.responseText)},i.onerror=function(e){r(e)},i.send(null)})},post:function(e,t,n){var r=this.createXMLHttpRequest();r.open("POST",e,!0),r.onreadystatechange=function(){4==r.readyState&&n(r.responseText)},r.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset:ISO-8859-1"),r.send(t)},callWebMethod:function(e,t,n){var r=this.createXMLHttpRequest();r.open("POST",e,!0),r.onreadystatechange=function(){4==r.readyState&&n(r.responseText)},r.setRequestHeader("Content-type","application/json; charset=utf-8"),r.send(t)},createXMLHttpRequest:function(){return new XMLHttpRequest}})}(n),function(e){var t;e.tabbly={execute:function(e){var n;t={sections:[],groups:[],details:[]};var r="",i="",o=!1;function a(e){return e&&e.trim().startsWith("@")?t[e.trim().split("@")[1].trim()]||"":e?e.trim():""}function s(e){for(var t=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,n={},r=t.exec(e);null!=r;)n[r[1].trim()]=a(r[2].trim().replace(/^'([^']*)'$/g,"$1")),r=t.exec(e);return n}return e.split("\n").forEach((function(e){!function(e,t){if(!r&&!e.trim())return function(){};var a;if(!/DEFINE|#|CREATE|SET|FUNCTION|END/.test(e)){if(r)return i+=t,i+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}if(/^#/.test(e))return function(){};if(/^SET (\w.*)/.test(e)){var c=e.match(/^SET (\w.*)$/);return o=!0,r=c[1].trim(),i="",function(){}}if(/^FUNCTION (\w.*)/.test(e)){var c=e.match(/^FUNCTION (\w.*)$/);return o=!1,r=c[1].trim(),i="",function(){}}if(/^END/.test(e)){var l=i,u=r;return r=i="",o?(o=!1,function(e){n[u]=l.trim()}):function(e){e[u]=new Function("ctx",l)}}if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(e)){c=e.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/);return a=c,function(e){e[a[1].trim()]=a[2].trim()}}if(!/^CREATE\s\s*(\w*) (.*)$/.test(e))throw new Error("Tabbly : Unrecognized text after DEFINE");return"section"==(c=e.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var e=c;return function(t){t.sections.push(s(e[2])),n=t.sections[t.sections.length-1]}}():"group"==c[1]?function(){var e=c;return function(t){t.groups.push(s(e[2])),n=t.groups[t.groups.length-1]}}():"detail"==c[1]?function(){var e=c;return function(t){t.details.push(s(e[2])),n=t.details[t.details.length-1]}}():void 0}(e.trim(),e)(t)})),{context:t}}}}(n),function(e){e.ReportEngine={},e.ReportEngine.generateReport=function(t,n,r){r.message({type:"report.begin"});var i=t||e.ReportEngine.rd,o=i.context.parseData?i.context.parseData(i,n,r.message):n;r.message({type:"report.log.message",text:"Inicializando..."}),console.time("Render");var a=function(t,n,i){r.send(e.templates.merge(t,n,i))};function s(){h.forEach((function(e,t){if(!(t<l))return r.message({type:"report.sections.group.header",value:e.id}),e.definition.header?a(e.definition.header,e,"compiled_headerfn"):e.definition.headerValueProvider?r.send(e.definition.headerValueProvider(e)):void 0}))}function c(e){var t=h.map((function(e){return e}));e&&t.splice(0,e),t.reverse().forEach((function(e){return r.message({type:"report.sections.group.footer",value:e.id}),e.definition.footer?a(e.definition.footer,e,"compiled_footerfn"):e.definition.footerValueProvider?r.send(e.definition.footerValueProvider(e)):void 0}))}var l=-1,u=function(){var e=JSON.parse(i.context.summary||"{}");return i.context.onInitSummaryObject?i.context.onInitSummaryObject(e):e}(),d=(i.context.sections||[]).where({type:"header"}),f=(i.context.sections||[]).where({type:"total"}),p=((i.context.sections||[]).where({type:"footer"}),i.context.details||[]),h=i.context.groups.map((function(t,n){return{name:"G"+(n+1),rd:i,definition:t,current:"",data:e.clone(u),init:function(t){var n=t[this.definition.key].toString(),r=self.BS[this.name];r.all[n]=r.all[n]||[],r.all[n].push(t),r.recordCount=1,!1!==this.__resume&&(this.__resume?e.ReportEngine.copy(t,this.data):(this.__resume=Object.keys(this.data).length>0)&&e.ReportEngine.copy(t,this.data))},sum:function(t){var n=t[this.definition.key].toString(),r=self.BS[this.name];r.all[n]=r.all[n]||[],r.all[n].push(t),r.recordCount+=1,!1!==this.__resume&&e.ReportEngine.sum(t,this.data)},test:function(e){return e[this.definition.key]==this.current}}}))||[];self.BS={reportDefinition:i,mediator:r},i.context.iteratefn&&(r.message({type:"report.log.message",text:"Inicializando elementos..."}),o.forEach(i.context.iteratefn)),i.context.orderBy&&(r.message({type:"report.log.message",text:"Ordenando datos..."}),o.sortBy(i.context.orderBy,!1)),self.BS={recordCount:0,G0:e.clone(u),dataSet:o,reportDefinition:i,mediator:r},h.forEach((function(e,t){e.current=o&&o[0]?o[0][e.definition.key]:"",self.BS[e.name]={recordCount:0,all:{}}})),i.context.onStartfn&&i.context.onStartfn(self.BS),[i.context.sections,i.context.details,i.context.groups].reduce((function(e,t){return e.concat(t)}),[]).map((function(t){t.valueProviderfn&&(t.valueProvider=e.templates.getValue(t.valueProviderfn,self),delete t.valueProviderfn),t.footerValueProviderfn&&(t.footerValueProvider=e.templates.getValue(t.footerValueProviderfn,self),delete t.footerValueProviderfn),t.headerValueProviderfn&&(t.headerValueProvider=e.templates.getValue(t.headerValueProviderfn,self),delete t.headerValueProviderfn)})),r.message({type:"report.render.rows"}),r.message({type:"report.log.message",text:"Generando informe..."}),d.forEach((function(e){return r.message({type:"report.sections.header",value:e}),e.template?a(e.template,e,"compiledfn"):e.valueProvider?r.send(e.valueProvider(e)):void 0})),o.length>0&&s(),o.forEach((function(t,n){if(self.BS.recordCount++,self.BS.isLastRow=o.length===self.BS.recordCount,self.BS.isLastRowInGroup=self.BS.isLastRow,self.BS.percent=self.BS.recordCount/o.length*100,self.BS.previous=self.BS.data||t,self.BS.data=t,h.forEach((function(e,t){self.BS[e.name].data=Object.create(e.data)})),e.ReportEngine.sum(t,self.BS.G0),i.context.onRowfn&&i.context.onRowfn(self.BS),r.message({type:"report.render.row",text:self.BS.percent.toFixed(1)+" %",value:self.BS.percent}),h.every((function(e){return e.test(t)}))?h.forEach((function(e){e.sum(t)})):(h.some((function(e,n){return!e.test(t)&&(c(l=n),h.forEach((function(e,r){r>=l?(e.init(t),l=n):e.sum(t)})),!0)})),h.forEach((function(e){e.current=t[e.definition.key]})),i.context.onGroupChangefn&&i.context.onGroupChangefn(self.BS),r.message({type:"report.sections.group.change",value:"__groups"}),s()),h.length&&!self.BS.isLastRow){var u=o[self.BS.recordCount];self.BS.isLastRowInGroup=!h.every((function(e){var t=e.definition.key;return u[t]===self.BS.data[t]}))}p.forEach((function(e){return r.message({type:"report.sections.detail",value:e.id}),e.template?a(e.template,e,"compiledfn"):e.valueProvider?r.send(e.valueProvider(e)):void 0}))})),o.length>0&&(self.BS.previous=self.BS.data,c()),f.forEach((function(e){return r.message({type:"report.sections.total",value:e.id}),e.template?a(e.template,e,"compiledfn"):e.valueProvider?r.send(e.valueProvider(e)):void 0})),r.message({type:"report.render.end"}),r.message({type:"report.end"}),r.flush(),console.timeEnd("Render")},e.ReportEngine.copy=function(e,t){Object.keys(t).map((function(n){t[n]=e[n]}))},e.ReportEngine.sum=function(e,t){Object.keys(t).map((function(n){t[n]+=e[n]}))},e.ReportEngine.compute=function(e,t){return e.reduce((function(e,n){return e+n[t]}),0)},e.ReportEngine.group=function(e,t){var n=e,r=function(e,i){return n.distinct((function(t){return t[e]})).forEach((function(r){t[r]=n.reduce((function(t,n,o,a){return n[e]==r?t+n[i]:t}),0)})),r};return r}}(n)}(r);var i=r.Pol;let o={},a=-1;var s={subscribe:function(e,t){o[e]||(o[e]=[]);var n=(++a).toString();return o[e].push({token:n,func:t}),n},publish:function(e,t){return!!o[e]&&(setTimeout((function(){for(var n=o[e],r=n?n.length:0;r--;)n[r].func(e,t)}),0),!0)},unsubscribe:function(e){for(var t in o)if(o[t])for(var n=0,r=o[t].length;n<r;n++)if(o[t][n].token===e)return o[t].splice(n,1),e;return!1},TOPICS:{VIEW_CHANGE:"view:change",VALUE_CHANGE:"value:change",MUNICIPIO_CHANGE:"municipio:change"}};const c="\n  <h1>{title}</h1>\n";const l="  \n  <p>{text}</p>\n";const u=["[on-click]","[on-publish]","[route-link]","[on-change]"];var d={addEventListeners:function(e,t,n){let r={innerHTML:(e,t)=>e.innerHTML=t,className:(e,t)=>e.className=t};u.forEach((o,a)=>{i.toArray(i.$(o,e)).forEach(e=>{let c=o.replace("[","").replace("]",""),l=e.attributes[c].value,u=l.split(":");if(0!==a){if(1===a){let o=i.templates.getValue(u[0],s);s.subscribe(o,(o,a)=>{let s=u[1];if(s){let o=r[s]||t[s]||i.templates.getValue(s,n);o&&o(e,a)}else r.innerHTML(e,a)})}if(2===a&&(e.onclick=function(e){let t=n.router,r=t.normalizePath(e.target.href);if(t.current!=r)try{t.navigateTo(r)}catch(e){console.log(e)}return!1}),3===a){let r="SELECT"===e.tagName;if("publish"===l)return void(r?e.onchange=()=>s.publish(s.TOPICS.VALUE_CHANGE,e):e.oninput=()=>s.publish(s.TOPICS.VALUE_CHANGE,e));let o=t[l]||i.templates.getValue(l,n);r?e.onchange=()=>o(e):e.oninput=()=>o(e)}}else{let r=t[u[0]]||i.templates.getValue(u[0],n);e.onclick=t=>{let i=u.slice(1).reduce((function(e,t){return e.push("@"==t.charAt(0)?getValue(t.slice(1),n):t),e}),[e,t]);return r.apply(n,i)}}})})}};const f='  \n  <div class="w3-dropdown-click">\n    <button on-click="toggleMenu" class="w3-button w3-black"><i class="fa fa-bars"></i></button>\n    <div class="w3-dropdown-content w3-bar-block w3-card-4">\n      <a href="templates" route-link on-click="hideMenu" class="w3-bar-item w3-button">Libros en <i>OpenLibra</i></a>\n      <hr style="margin:0"/>\n    </div>\n  </div>\n  <a href=""          route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button selected">Inicio</a>\n  <a href="el-tiempo" route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">El tiempo</a>\n  <a href="list"      route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">Notas</a>\n  <a href="note"      route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">+</a>\n  <a href="about"     route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button w3-right">?</a>\n  ';class p{constructor(e){this.dbname=e,this.db=""}openDb(){return new Promise((e,t)=>{let n=window.indexedDB.open(this.dbname,1);n.onsuccess=t=>{this.db=t.target.result,e(this.db)},n.onerror=e=>{t("Error")},n.onupgradeneeded=e=>{this.db=e.target.result;try{this.db.objectStoreNames&&this.db.objectStoreNames.contains("notas")&&this.db.deleteObjectStore("notas")}catch(e){console.log(e)}this.db.createObjectStore("notas",{keyPath:"key"})}})}readAll(e){return new Promise((t,n)=>{var r=[];this.db.transaction(e,"readonly").objectStore(e).openCursor(IDBKeyRange.lowerBound(0)).onsuccess=e=>{var n=e.target.result;n?(r.push(n.value),n.continue()):t(r)}})}save(e,t){return new Promise(n=>{var r;(r=this.db.transaction(e,"readwrite").objectStore(e).put(t)).onsuccess=e=>{n(t)},r.onerror=e=>{console.log(e)}})}delete(e,t){return new Promise(n=>{var r;(r=this.db.transaction(e,"readwrite").objectStore(e).delete(t)).onsuccess=e=>{n()},r.onerror=e=>{console.log(e)}})}readOne(e,t){return new Promise(n=>{var r;(r=this.db.transaction(e,"readwrite").objectStore(e).get(t)).onsuccess=e=>{n(e.target.result)},r.onerror=e=>{console.log(e)}})}}const h='\n<div class="w3-border-bottom w3-animate-left" style="padding:0; font-size:14px;" id="note-{note.key}">\n  <div class="w3-container" style="padding:5px">\n    <div on-click="expandCollapse"><b>{note.title}</b><i class="w3-right w3-large fa fa-caret-down"></i></div>\n  </div>\n  <div class="w3-container" style="display:none;padding:0 4px">\n    <p id="editp-{note.key}" on-click="editNote" style="padding:2px;min-height:4em;margin:2px 0;white-space: pre-wrap">{formatText:note.text}</p>\n    <div class="w3-bar w3-center" style="padding:4px 0;">\n      <button type="button" id="delete-{note.key}" on-click="deleteNote" class="w3-button w3-border"><i class="fa fa-trash" aria-hidden="true"></i></button>\n      <button type="button" id="fav-{note.key}" on-click="saveFavorites" class="w3-button w3-border"><i class="fa {css:note.key}" aria-hidden="true"></i></button>\n      <button type="button" id="edit-{note.key}" on-click="editNote" class="w3-button w3-border"><i class="fa fa-edit" aria-hidden="true"></i></button>\n    </div>\n  </div>\n</div>';const m=s.TOPICS;var v=function(e){let t,n,r={root:{},init:function(e){},render:function(e){return this.root=i.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-left">\n  <h2>Nueva nota</h2>\n  <form class="w3-margin-bottom">\n    <label for="txt-title">Título</label>\n    <input on-change="onChange" class="w3-input w3-border" type="text" id="txt-title" placeholder="Introduce un título" >\n    <label for="txt-text">Texto</label>\n    <textarea on-change="publish" class="w3-input w3-border" id="txt-text" rows="4" placeholder="Contenido de la nota"></textarea>\n  </form>\n  <div class="w3-container w3-margin-bottom w3-center w3-animate-zoom">\n    <button type="button" id="btn-grabar" class="w3-button w3-black">Grabar</button>\n  </div>\n</div>\n'),this.root},mounted:function(a){!function(){let a=r.root.firstElementChild;a.style.display="none",d.addEventListeners(a,{},{onChange:e=>{console.log("onChange_fn",e.value)}}),s.subscribe(m.VALUE_CHANGE,(e,t)=>{console.log("value.change",t.value)}),n=new p("notas-app.db"),n.openDb().then(()=>{let s=function(){a.style.display="",i.$("btn-grabar").onclick=o},c=e.router.current.params[1]||"";c?n.readOne("notas",parseInt(c)).then(e=>{t=e,i.$("txt-title").value=t.title,i.$("txt-text").value=t.text,i.$("h2",r.root)[0].innerHTML="Edición de nota",s()}):s()})}()}};function o(){var r=i.$("txt-title"),o=i.$("txt-text"),a=r.value.trim(),s=o.value.trim();if(!a)return void setTimeout(()=>r.focus(),20);if(!s)return void setTimeout(()=>o.focus(),20);let c=new Date;n.save("notas",{key:t?t.key:c.valueOf(),date:t?t.date:"{0}/{1}/{2}".format(c.getDate(),c.getMonth,c.getFullYear()),title:a,text:s}).then(t=>{e.router.navigateTo("list")})}return r};const w=s.TOPICS;const g=s.TOPICS,b=[{title:"Notas App",init:function(e){},render:function(e){let t={id:"appHeader",innerHTML:c.format(this),className:"w3-container w3-teal"};return i.build("header",t)},mounted:function(e){}},function(){let e,t={root:{},id:"menu.component.ref",init:function(e,t){this.router=t},render:function(e){let t={id:"appMenu",innerHTML:f.format(this),className:"w3-bar w3-black"};return this.root=i.build("nav",t),this.root},mounted:function(e){d.addEventListeners(t.root,t.eventHandlers,{router:t.router,toggleMenu:n,hideMenu:r})},eventHandlers:{sync:function(e,t){r(),t.name===e.href.split("/").lastItem()?e.classList.add("selected"):e.classList.remove("selected")}}};function n(t){e=t.nextElementSibling,e.classList.toggle("w3-show")}function r(t){e&&e.classList.remove("w3-show")}return t}(),{root:{},init:function(e){},render:function(e){let t={id:"app-content-container",innerHTML:"",className:"w3-container",style:{minHeight:"440px",padding:"0 0 60px 0"}};return i.build("section",t)},mounted:function(e){!function(){function e(){var e=document.getElementById("appMenu");if(!e.className.includes("sticky")){var t=e.offsetTop;window.onscroll=function(){window.pageYOffset>=t?e.classList.add("sticky"):e.classList.remove("sticky")}}}var t,n,r,i;window.addEventListener("resize",(t=e,n=150,function(){var e=this,o=arguments,a=function(){i=null,r||t.apply(e,o)},s=r&&!i;clearTimeout(i),i=setTimeout(a,n),s&&t.apply(e,o)}),!1),e()}()}},{text:"© Rafael Castro Gómez, 2020",init:function(e){},render:function(e){let t={id:"appFooter",innerHTML:l.format(this),className:"w3-container w3-teal w3-center"};return i.build("footer",t)},mounted:function(e){}}],y={routes:[],addRoute:function(e,t,n){return this.routes.push({name:e,path:t,controler:n}),this},getRoute:function(e){return this.routes.where((function(t){let n=t.path.exec(e);return n&&(t.params=n.map(e=>e)),n}))[0]},navigateTo:function(e){this.current=this.getRoute(e);let t="{origin}{0}{1}".format(APP_PATH,e,location);window.history.pushState({},e,t),k()},normalizePath:function(e){return e.replace(document.baseURI,"")},sync:function(){this.current=this.getRoute(this.normalizePath(window.location.href)),k()},current:{}};y.addRoute("list",/list$/,(function(e){let t,n,r=[],o=[],a={root:{},init:function(e){},render:function(e){return this.root=i.build("div",'\n<div notas-container style="padding:0; margin-bottom:43px;" class="w3-animate-left"></div>\n<button btn-add-note on-click="addNote" class="w3-button w3-black w3-circle">＋</button>'),n=this.root.firstElementChild,this.root},mounted:function(e){t=new p("notas-app.db"),t.openDb().then(e=>{s()}),d.addEventListeners(a.root,a.eventHandlers)},eventHandlers:{addNote:function(t,n){e.router.navigateTo("note")},deleteNote:function(e,n){let i=parseInt(e.id.split("-")[1]),o=r.where({key:i})[0],a=document.getElementById("note-{0}".format(i));t.delete("notas",i).then(()=>{r.remove(o),a.parentNode.removeChild(a)})},expandCollapse:function(e,t){let n=e.parentNode.nextElementSibling.style;"none"==n.display?(n.display="",e.querySelector("i").classList.remove("fa-caret-down"),e.querySelector("i").classList.add("fa-caret-up")):(n.display="none",e.querySelector("i").classList.remove("fa-caret-up"),e.querySelector("i").classList.add("fa-caret-down"))},saveFavorites:function(e,t){let n=e.firstElementChild,r=e.id.split("-")[1];o.includes(r)?(o.remove(r),n.classList.add("fa-star-o"),n.classList.remove("fa-star")):(o.push(r),n.classList.remove("fa-star-o"),n.classList.add("fa-star"));window.localStorage.setItem("favorites",o.join("-"))},editNote:function(t,n){e.router.navigateTo("note/"+t.id.split("-")[1])}}};function s(){t.readAll("notas").then(e=>{r=e.reverse(),o=(window.localStorage.getItem("favorites")||"").split("-"),n.innerHTML="",r.map(e=>{let t={note:e,formatText:function(e){return e},css:function(e){return o.includes(e.toString())?"fa-star":"fa-star-o"}};return i.build("div",h.format(t))}).map(e=>e.firstElementChild).forEach(e=>{n.appendChild(e)}),d.addEventListeners(n,a.eventHandlers)})}return a})).addRoute("about",/about$/,(function(){return{root:{},init:function(e){},render:function(e){return this.root=i.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-left">\n  <h1>Sobre Notas App</h1>\n  <p style="text-indent:1em;">\n    Notas App es una prueba de concepto de lo que podría ser un <span class="w3-bold w3-italic">framework</span> \n    sencillo con el cual desarrollar aplicaciones <span class="w3-bold w3-italic">SPA</span> basadas únicamente en <span class="w3-bold">HTML5</span> y <span class="w3-bold">JavaScript</span>.\n  </p>\n  <p style="text-indent:1em;">\n    Estas aplicaciones serían subceptibles de ser instaladas en dispositivos móviles como una <span class="w3-bold w3-italic">PWA</span>.\n  </p>\n  <ul class="w3-ul w3-border">\n    <li><h2>Referencias</h2></li>\n    <li><a href="https://es.wikipedia.org/wiki/Single-page_application" target="_blank">SPA (Single-page application)</a></li>\n    <li><a href="https://es.wikipedia.org/wiki/Progressive_Web_Apps" target="_blank">PWA (Progressive Web Apps)</a></li>\n    <li><h2>Repositorio</h2></li>\n    <li><a href="https://github.com/rcastrogo/notas-app" target="_blank">https://github.com/rcastrogo/notas-app</a></li>\n  </ul>\n  <p style="text-indent:1em;">\n    Para su desarrollo no se han utilizado ninguno de los <span class="w3-bold w3-italic">frameworks</span> existentes como pueden ser Angular, React o Vue.js.\n  </p>\n</div>\n<div class="w3-container w3-margin-bottom w3-center">\n  <button type="button" about-btn-back class="w3-button w3-black">Volver</button>\n</div>\n'),this.root},mounted:function(e){e.querySelector("[about-btn-back]").onclick=()=>{history.back()}}}})).addRoute("note",/note$/,v).addRoute("note",/note\/(\d{13})$/,v).addRoute("el-tiempo",/el-tiempo$/,(function(e){let t,n,r,o,a={root:{},data:{municipios:{45022:"Buenaventura (TOLEDO)",28079:"Madrid"}},init:function(e){},render:function(e){return this.root=i.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-bottom">\n  <div class="w3-border w3-margin-top">\n    <button on-click="expandCollapse" class="w3-button w3-block w3-left-align">\n      <span on-publish="TOPICS.MUNICIPIO_CHANGE:innerHTML">Buenaventura</span><i class="w3-right w3-large fa fa-caret-down"></i>\n    </button>\n    <div class="w3-hide">\n      <ul class="w3-ul">\n        <li on-click="requestData" id="loc-45022">Buenaventura</li>\n        <li on-click="requestData" id="loc-28079">Madrid</li>\n      </ul>\n    </div>\n  </div>\n  <div class="w3-margin-top w3-hide" id="aemetApi-container" style="padding:0;">\n    <div id="progress-bar-container">\n      <div class="w3-center">Cargando datos desde la AEMET...</div>\n      <div class="w3-border">\n        <div id="progress-bar" class="w3-green" style="height:24px;width:0%"></div>\n      </div>\n    <div>\n  </div>\n</div>'),this.root},mounted:function(e){t=i.$("aemetApi-container"),r=i.$("progress-bar"),n=i.$("progress-bar-container"),d.addEventListeners(a.root,a.eventHandlers,{css:(e,t)=>{console.log(e)}}),l()},dispose:function(){clearInterval(o)},eventHandlers:{expandCollapse:u,requestData:function(e,t){let n=e.parentNode.parentNode.previousElementSibling;c=e.id.split("-")[1],s.publish(w.MUNICIPIO_CHANGE,a.data.municipios[c]),u(n),l()}}};let c=45022;function l(){!function(){let e=0;r.style.width="{0}%".format(e),o&&clearInterval(o),o=setInterval(()=>{e=(e+9)%100,r.style.width="{0}%".format(e)},300)}(),t.innerHTML="",t.appendChild(n),t.classList.remove("w3-hide");const a="https://opendata.aemet.es/opendata/api/prediccion/especifica/municipio/horaria/"+c+"?api_key=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyY2FzdHJvZ29AaG90bWFpbC5jb20iLCJqdGkiOiJmZmI3OWJjZi1lZWQwLTQwODMtYTkwZC04MmNkMmRhMTA2MjQiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTU4MjcyNTg3NiwidXNlcklkIjoiZmZiNzliY2YtZWVkMC00MDgzLWE5MGQtODJjZDJkYTEwNjI0Iiwicm9sZSI6IiJ9.bPhAJDutP62_75peo3qr88Qs1JQ4jmu6TWXHjvIzZx0";i.ajax.get(a,e=>{e.setRequestHeader("Accept","application/javascript")}).then(e=>JSON.parse(e)).then(e=>{if(200==e.estado)return i.ajax.get(e.datos);throw new Error(e.descripcion)}).then(n=>{var r;t.innerHTML="",(r=function(){const e='\n  <div class="w3-container w3-teal w3-center w3-small w3-padding">\n    {fn.formatFecha:elaborado}\n  </div>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{fn.formatFecha:prediccion.dia[0].fecha:day}</h3>\n    <div>{fn.showDay:rows-0}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[0].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[0].ocaso}</div>\n    </div>\n  </div>\n  <br/>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{fn.formatFecha:prediccion.dia[1].fecha:day}</h3>\n    <div>{fn.showDay:rows-1}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[1].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[1].ocaso}</div> \n    </div>\n  </div>\n  <br/>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{fn.formatFecha:prediccion.dia[2].fecha:day}</h3>\n    <div>{fn.showDay:rows-2}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[2].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[2].ocaso}</div>\n    </div>\n  </div>';let t={formatFecha:function(e,t,n){let r=e.split("T");if(n&&"date"===n[0])return r[0];if(n&&"time"===n[0])return r[1];if(n&&"day"===n[0]){r=r[0].split("-");let e=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sabado"],t=new Date(~~r[0],~~r[1]-1,~~r[2]).getDay();return"{0} {1}".format(e[t],~~r[2])}return"{1} - {0}".format(...r)},showDay:function(e){return e.reduce((function(e,n){let r='\n          <tr class="w3-center">\n            <td>{row.periodo}:00</td>\n            <td>{row.cielo}</td>\n            <td>{row.temperatura}</td>\n            <td>{fn.formatZero:row.lluvia}</td>\n            <td><i class="fa fa-2x fa-long-arrow-right pol-{row.viento[0]}"></i> {row.viento[1]}</td>\n          </tr>',i={row:n,fn:t};return e.append(r.format(i))}),i.stringBuilder().append('<table class="w3-table w3-bordered w3-small w3-striped">').append('<tr class="w3-center w3-teal"><th>Hora</th><th>Cielo</th><th>Temp<br>ºC</th><th>Lluvia<br>mm</th><th>Viento<br>km/h</th></tr>')).append("</table>").value},formatZero:function(e){return"0"==e?"":e}};return{root:{},init:function(e){},render:function(t){return this.root=i.build("div",e.format(this.data)),this.root},mounted:function(e){},withData:function(e){let n=(r=new Date,"{0#0000}-{1#00}-{2#00}-{3#00}".format(r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours()));var r;return this.data=JSON.parse(e)[0],this.data.fn=t,this.data.prediccion.dia.reduce((function(e,t,r){let i=t.fecha.fixDate("T"),o=[].concat(t.estadoCielo.map((function(e){return{t:"c",periodo:e.periodo,value:e.descripcion}})),t.temperatura.map((function(e){return{t:"t",periodo:e.periodo,value:e.value}})),t.precipitacion.map((function(e){return{t:"p",periodo:e.periodo,value:e.value}})),t.vientoAndRachaMax.where(e=>e.velocidad).map((function(e){return{t:"v",periodo:e.periodo,value:[e.direccion[0],e.velocidad[0]]}}))).where(e=>"{0}-{1}".format(i,e.periodo)>=n).groupBy("periodo");return e["rows-{0}".format(r)]=Object.keys(o).reduce((function(e,t){let n=o[t];return e.push({periodo:t,cielo:n.where({t:"c"})[0].value,temperatura:n.where({t:"t"})[0].value,lluvia:n.where({t:"p"})[0].value,viento:n.where({t:"v"})[0].value}),e}),[]).sortBy("periodo"),e}),this.data),this}}}().withData(n)).init(e),t.appendChild(r.render()),r.mounted(e)}).catch(e=>{console.log(e)})}function u(e,t){let n=e.nextElementSibling.classList;n.contains("w3-hide")?(n.remove("w3-hide"),e.querySelector("i").classList.remove("fa-caret-down"),e.querySelector("i").classList.add("fa-caret-up")):(n.add("w3-hide"),e.querySelector("i").classList.remove("fa-caret-up"),e.querySelector("i").classList.add("fa-caret-down"))}return a})).addRoute("templates",/templates$/,(function(e){let t,n={root:{},data:{},init:function(e){},render:function(e){return this.root=i.build("div",'\n  <div class="w3-container w3-margin-bottom w3-animate-left">\n\n  </div>'),t=this.root.firstElementChild,this.root},mounted:function(e){r({tipo:"cat",id:"libros_programacion"})},dispose:function(){},eventHandlers:{}};function r(e){const n="http://www.etnassoft.com/api/v1/get/?num_items=25&{0}{1}decode=true".format("cat"===e.tipo?"category={0}&".format(e.id):"","tag"===e.tipo?"any_tags=[{0}]&".format(e.id):"");var o;t.innerHTML="",(o=n,new Promise((function(e,t){var n=n||1e4,r="jsonp_callback_"+Date.now(),i=document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("script");a.src=o+function(e){return e.indexOf("?")>=0?"&":"?"}(o)+"callback="+r,a.async="true",window[r]=function(t){c(),e(JSON.stringify(t))},a.onerror=function(){c(),t(Error("Network error loading "+a.src))},i.appendChild(a);var s=setTimeout((function(){c(),t(Error("Request to "+o+" failed to execute callback after "+n+"ms."))}),n);function c(){s&&clearTimeout(s),window[r]&&delete window[r],a&&i.removeChild(a)}}))).then(JSON.parse).then(e=>{!function(e){let n=i.build("div",'\n      <div class="w3-card-4 w3-margin-top w3-margin-bottom w3-center">\n        <header class="w3-container w3-light-grey">\n          <h1>Libros</h1>\n        </header>\n        <span xbind="" class="w3-small">{this.length} Elementos</span>\n      </div>\n      <div xfor="libro in this" class="w3-card-4 w3-margin-bottom">\n        <header class="w3-container w3-light-grey" on-click="expandCollapse">\n          <h4 xbind="">{libro.title}</h4>\n        </header>\n        <div class="w3-container" style="transition: height .51s; overflow: hidden">\n\n          <div xbind="" class="w3-container" style="padding:3px 0">\n            <img xbind="src:libro.thumbnail" alt="Portada" class="w3-left w3-margin-right w3-margin-bottom">\n            <b>Autor</b> {libro.author}<br/>\n            <b>Páginas</b> {libro.pages}<br/>\n            <b>Año</b> {libro.publisher_date}\n            <b>Por</b> {libro.publisher}\n            <b>Idioma</b> {libro.language}\n            <p xbind="id:fn.formatId @libro.ID,book" \n               on-click="showAllContent" \n               style="clear:both;margin-block-start: 0; font-style: oblique;font-family: monospace;">\n              {libro.content_short}\n            </p>\n          </div>\n\n          <div class="w3-small" xbind="">Categorías ({libro.categories.length})</div>\n          <div class="w3-border w3-light-grey w3-small w3-round" style="overflow:scroll;width:100%">\n            <div book-cat xfor="categoria in libro.categories" class="w3-cell">\n              <p xbind="id:categoria.nicename;innerHTML:categoria.name" on-click="makeRequest:cat" class="w3-border w3-round w3-white" style="padding:6px;margin:6px;white-space:nowrap;"></p>\n            </div>\n          </div>\n\n          <div class="w3-small" xbind="">Etiquetas ({libro.tags.length})</div>\n          <div class="w3-border w3-light-grey w3-small w3-round w3-margin-bottom" style="overflow:scroll;width:100%">\n            <div book-cat xfor="etiqueta in libro.tags" class="w3-cell">\n              <p xbind="id:etiqueta.nicename;innerHTML:etiqueta.name" on-click="makeRequest:tag" class="w3-border w3-round w3-white" style="padding:6px;margin:6px;white-space:nowrap;"></p>\n            </div>\n          </div>\n        </div>\n      </div>\n    ');e.fn={formatId:function(e,t,n,r){return"{0}-{1}".format(r,n)}};let o=e.toDictionary("ID");t.appendChild(i.templates.fill(n,e)),d.addEventListeners(t,{},{showAllContent:(e,t)=>{e.onclick=void 0;let n=e.id.split("-")[1];e.innerHTML=o[n].content},makeRequest:function(e,t,n){r({tipo:n,id:e.id})},expandCollapse:function(e,t){let n=e.nextElementSibling.style;"0px"==n.height?n.height="{0}px".format(e.__lastHeight||""):(e.__lastHeight=e.nextElementSibling.clientHeight,n.height="0px")}})}(e.sortBy("title"))}).catch(e=>{console.log(e)})}return n})).addRoute("",/$/,(function(){return{root:{},init:function(e){},render:function(e){return this.root=i.build("div",'  \n  <div class="w3-container w3-center w3-animate-left" style="padding-top:60px;">\n    <img src="./assets/img/logo.png" alt="logo" style="width: 300px">\n    <p>La app que te permite almacenar todas tus notas en el móvil!!!</p>\n  </div>').firstElementChild,this.root},mounted:function(e){},dispose:function(){}}})),function(){const e=i.$("appContent");b.forEach(t=>{t.init&&t.init(e,y),e.appendChild(t.render(e)),t.mounted&&t.mounted(e)})}();const x=i.$("app-content-container");let E,S;function k(){let e=y.current.controler;S&&E==e||(S&&S.dispose&&S.dispose(),x.innerHTML="",S=e({router:y}),E=e,S.init&&S.init(),x.appendChild(S.render()),S.mounted&&S.mounted(x),s.publish(g.VIEW_CHANGE,y.current))}y.sync(),window.onpopstate=function(){y.sync()},window.addEventListener("load",()=>{if("serviceWorker"in navigator)try{navigator.serviceWorker.register("serviceWorker.js"),console.log("Service Worker Registered")}catch(e){console.log("Service Worker Registration Failed")}})}]);