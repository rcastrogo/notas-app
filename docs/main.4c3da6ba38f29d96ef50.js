!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e){t.exports='<div>\r\n  <div class="w3-bar w3-black">\r\n    <button on-click="goBack" class="pol-btn w3-button w3-black"><i class="fa fa fa-chevron-left"></i></button>\r\n    <span on-publish="msg\\page_component\\update\\title:innerHTML">Imagen</span>\r\n  </div>   \r\n</div>\r\n'},function(t,e){t.exports='<div class="w3-animate-left img-container" on-click="notify">\r\n</div>'},function(t,e){t.exports='<div class="w3-animate-left page-container">\r\n</div>'},function(t,e){t.exports='<div class="w3-animate-left page-container">\r\n</div>'},function(t,e){t.exports='<div class="w3-animate-left page-container">\r\n</div>'},function(t,e){t.exports='<div class="" activity-container>\r\n\r\n\t<div xbind="id:fn.formatId => @activity.id activity" xfor="activity in activities" class="w3-padding-small w3-margin-top w3-border-bottom" activity>\r\n\t\t\r\n\t\t<div>\r\n\t\t\t<img xbind="src:athlete.profile_medium" class="w3-left w3-circle" style="margin-right:10px">\r\n\t\t\t<p xbind style="padding:5px;margin:0;min-height:63px;">\r\n\t\t\t  <b xbind>{athlete.firstname} {athlete.lastname}</b><br/>\r\n\t\t\t  <span class="w3-small w3-text-gray" xbind>{activity.start_date_local:fn.formatDate} {activity.start_date_local:fn.formatTime}</span>\r\n\t\t\t</p>\r\n\t\t\t<div xbind class="w3-bold w3-large">{activity.name}</div>\r\n\t\t\t<div xbind="id:fn.formatId => @activity.id desc" act-desc></div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Distancia</div>\r\n\t\t\t\t<div class="w3-bold w3-30" xbind>{activity.distance:fn.toKilometers}<span class="w3-small"> km</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Tiempo</div>\r\n\t\t\t\t<div class="w3-bold w3-30" xbind>{activity.moving_time:fn.formatDuration}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row  w3-center">\r\n\t\t\t<div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Velocidad media</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_speed:fn.formatSpeed}<span class="w3-small"> km/h</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Velocidad máxima</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.max_speed:fn.formatSpeed}<span class="w3-small"> km/h</span></div>\r\n\t\t\t</div>\r\n    </div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Pulsaciones medias</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_heartrate|toFixed,0}<span class="w3-small"> ppm</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Pulsaciones máximas</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.max_heartrate}<span class="w3-small"> ppm</span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.total_elevation_gain">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Desnivel</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.total_elevation_gain|toLocaleString,de-DE}<span class="w3-small"> m</span></div>\r\n\t\t\t</div>\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.average_cadence">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Cadencia</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_cadence|toFixed,0}<span class="w3-small"></span></div>\r\n\t\t\t</div>\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.average_watts">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Potencia media</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_watts|toFixed,0}<span class="w3-small"> W</span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div xbind=":fn.showIf=>@activity.total_photo_count" class="w3-center w3-small w3-light-grey">{activity.fotos.length} Fotos</div>\r\n\t\t<div xbind=":fn.showIf=>@activity.total_photo_count" class="" style="overflow:auto;">\r\n\t\t\t<div style="width:380px">\r\n\t\t\t\t<img xfor="foto in activity.fotos" xbind="id:foto" height="80" style="min-width:100px;" class="foto">\r\n\t\t  </div>\r\n\t\t</div>\r\n\r\n\t  <div xbind=":fn.xif=>@activity.map.summary_polyline;id:fn.formatId => @activity.id map" \r\n\t\t     class="w3-margin-bottom w3-light-gray" \r\n\t\t\t\t style="min-height:100px"\r\n\t\t\t\t act-map-img>\r\n\t\t</div>\r\n\r\n\t\t<p class="w3-center">\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.achievement_count" class="w3-large"><i class="fa fa-trophy"></i> {activity.achievement_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.comment_count" class="w3-large"><i class="fa fa-comments"></i> {activity.comment_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.kudos_count" class="w3-large"><i class="fa fa-thumbs-up"></i> {activity.kudos_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIfGreather=>@activity.athlete_count 1" class="w3-large"><i class="fa fa-bicycle"></i> {activity.athlete_count}</span>\r\n\t\t</p>\r\n\r\n\t</div>\r\n\r\n</div>\r\n'},function(t,e){t.exports='<div class = "w3-padding w3-teal w3-round">\r\n\r\n</div>\r\n'},function(t,e){t.exports='<div class="" activity-container>\r\n\r\n\t<div xbind="id:fn.formatId => @activity.id activity" xfor="activity in activities" class="w3-padding-small w3-margin-top w3-border-bottom" activity>\r\n\t\t\r\n\t\t<div>\r\n\t\t\t<img xbind="src:athlete.profile_medium" class="w3-left w3-circle" style="margin-right:10px">\r\n\t\t\t<p xbind style="padding:5px;margin:0;min-height:63px;">\r\n\t\t\t  <b xbind>{athlete.firstname} {athlete.lastname}</b><br/>\r\n\t\t\t  <span class="w3-small w3-text-gray" xbind>{activity.start_date_local:fn.formatDate} {activity.start_date_local:fn.formatTime}</span>\r\n\t\t\t</p>\r\n\t\t\t<div xbind class="w3-bold w3-large">{activity.name}</div>\r\n\t\t\t<div xbind="id:fn.formatId => @activity.id desc" act-desc></div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Distancia</div>\r\n\t\t\t\t<div class="w3-bold w3-30" xbind>{activity.distance:fn.toKilometers}<span class="w3-small"> km</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Tiempo</div>\r\n\t\t\t\t<div class="w3-bold w3-30" xbind>{activity.moving_time:fn.formatDuration}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row  w3-center">\r\n\t\t\t<div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Velocidad media</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_speed:fn.formatSpeed}<span class="w3-small"> km/h</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Velocidad máxima</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.max_speed:fn.formatSpeed}<span class="w3-small"> km/h</span></div>\r\n\t\t\t</div>\r\n    </div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Pulsaciones medias</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_heartrate|toFixed,0}<span class="w3-small"> ppm</span></div>\r\n\t\t\t</div>\r\n\t\t  <div class="w3-cell">\r\n\t\t\t  <div class="w3-small w3-light-grey">Pulsaciones máximas</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.max_heartrate}<span class="w3-small"> ppm</span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="w3-cell-row w3-center">\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.total_elevation_gain">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Desnivel</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.total_elevation_gain|toLocaleString,de-DE}<span class="w3-small"> m</span></div>\r\n\t\t\t</div>\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.average_cadence">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Cadencia</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_cadence|toFixed,0}<span class="w3-small"></span></div>\r\n\t\t\t</div>\r\n\t\t\t<div class="w3-cell" xbind=":fn.showIf=>@activity.average_watts">\r\n\t\t\t\t<div class="w3-small w3-light-grey">Potencia media</div>\r\n\t\t\t\t<div class="w3-bold w3-large" xbind>{activity.average_watts|toFixed,0}<span class="w3-small"> W</span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t  <div xbind=":fn.showIf=>@activity.map.polyline" \r\n\t\t     class="w3-margin-bottom w3-light-gray" \r\n\t\t\t\t style="min-height:100px">\r\n\t\t\t\t <img act-img xbind="id:fn.formatId => @activity.id img" class="w3-border" style="width:100%">\r\n\t\t</div>\r\n\r\n\t\t<p class="w3-center">\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.achievement_count" class="w3-large"><i class="fa fa-trophy"></i> {activity.achievement_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.comment_count" class="w3-large"><i class="fa fa-comments"></i> {activity.comment_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIf=>@activity.kudos_count" class="w3-large"><i class="fa fa-thumbs-up"></i> {activity.kudos_count}</span>\r\n\t\t\t<span style="margin-right: 3px" xbind=":fn.showIfGreather=>@activity.athlete_count 1" class="w3-large"><i class="fa fa-bicycle"></i> {activity.athlete_count}</span>\r\n\t\t</p>\r\n\r\n\t</div>\r\n\r\n</div>\r\n'},function(t,e,n){"use strict";n.r(e);let i={};!function(t,e){var n=t.Pol={apply:function t(e,n,i){if(i&&t(e,i),e&&n&&"object"==typeof n)for(var a in n)"object"==typeof n[a]?t(e[a],n[a]):e[a]=n[a];return e}};!function(t){t.apply(t,{toArray:function(t){return Array.prototype.slice.call(t)},isNull:function(t){return null===t},isArray:function(t){return Array.isArray(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isNumber:function(t){return"number"==typeof t},isFunction:function(t){return"function"==typeof t},isObject:function(t){return t&&"object"==typeof t},clone:function(e){return t.isArray(e)?e.slice(0):t.isObject(e)&&e.clone?e.clone():t.isObject(e)?Object.keys(e).reduce((function(n,i){return n[i]=t.clone(e[i]),n}),{}):e},join:function(t,e,n){return t.reduce((function(t,n){return t.append(n[e||"id"])}),[]).join(void 0===n?"-":n||"")},stringBuilder:function(t){return{value:t||"",append:function(t){return this.value=this.value+t,this},appendLine:function(t){return this.value=this.value+(t||"")+"\n",this}}},build:function(e,i,a){let o=t.isString(i)?{innerHTML:i}:i,r=n.apply(document.createElement(e),o);return a?r.firstElementChild:r},$:function(e,n){return"string"==typeof e?document.getElementById(e)||t.toArray((n||document).querySelectorAll(e)||[]):e},parseQueryString:function(){return location.search.slice(1).split("&").reduce((t,e)=>(t[e.split("=")[0]]=e.split("=")[1]||"",t),{})}})}(n),function(t){t.apply(String,{stringBuilder:t.stringBuilder,leftPad:function(t,e,n){var i=""+t;for(null!=n&&""!==n||(n=" ");i.length<e;)i=n+i;return i},trimValues:function(t){return t.map((function(t){return t.trim()}))}}),t.apply(String.prototype,{replaceAll:function(t,e){return this.split(t).join(e)},repeat:String.prototype.repeat||function(t){return new Array(t+1).join(this)},contains:String.prototype.includes||function(t,e){return this.indexOf(t)>=(e||0)},startsWith:String.prototype.startsWith||function(t){return 0==this.indexOf(t)},toFloat:function(){return this.trim().replaceAll(".","").replaceAll(",",".")},fixDate:function(t){return this.split(t||" ")[0]},fixTime:function(t){return this.split(t||" ")[1]},fixYear:function(){return this.fixDate().split("/")[2]},trimSeconds:function(){return this.split(":")[0]+":"+this.split(":")[1]},paddingLeft:function(t){return(t+this).slice(-t.length)},format:function(){var e=arguments,n=e[e.length-1]||self,i=function(e,i,a){var o=String.trimValues(i).reduce((function(e,i){return e.push("@"==i.charAt(0)?t.templates.getValue(i.slice(1),n):i),e}),a);return e.apply(n,o)};return this.replace(/\{(\d+|[^{]+)\}/g,(function(a,o){let r,[s,l]=String.trimValues(o.split(":"));if(/^\d+/.test(s)){let i=String.trimValues(s.split("|")),a=i[0],o=0==i.length?"data":["data"].concat(i.slice(1)).join("|"),l={data:e[a],outerScope:n};r=t.templates.getValue(o,l)}else r=t.templates.getValue(s,n);if(t.isFunction(r))return i(r,l?l.split(/\s|\;/):[],[]);if(l){let[e,a]=String.trimValues(l.split(/=>/));return a=a?a.split(/\s|\;/):[],i(t.templates.getValue(e,n),a,[r])}return r}))},htmlDecode:function(){return(new DOMParser).parseFromString(this,"text/html").documentElement.textContent}})}(n),function(t){t.apply(Date.prototype,{format:function(t){return"yyyymmdd"==t?"{2|paddingLeft,0000}/{1|paddingLeft,00}/{0|paddingLeft,00}".format(this.getDate().toString(),(this.getMonth()+1).toString(),this.getFullYear().toString()):"{0|paddingLeft,00}/{1|paddingLeft,00}/{2|paddingLeft,0000}".format(this.getDate().toString(),(this.getMonth()+1).toString(),this.getFullYear().toString())}})}(n),function(t){t.apply(Array.prototype,{remove:function(t){var e=this.indexOf(t);return-1!=e&&this.splice(e,1),this},add:function(t){return this.push(t),t},append:function(t){return this.push(t),this},item:function(t,e,n){return 1==arguments?this.filter((function(e){return e.id==t||e._id==t}))[0]||n:this.filter((function(n){return n[t]==e}))[0]||n},contains:function(t,e){return this.item(t,e)},lastItem:function(){return this[this.length-1]},select:function(t){return this.map(t)},where:function(e){return t.isFunction(e)?this.filter(e):t.isObject(e)?this.filter(new Function("a",Object.keys(e).reduce((function(n,i,a){return n+(a>0?" && ":"")+((o=e[i])instanceof RegExp?"{1}.test(a.{0})".format(i,o):t.isString(o)?"a.{0} === '{1}'".format(i,o):"a.{0} === {1}".format(i,o));var o}),"return "))):this},sortBy:function(t,e){var n=[],i=t.split(",").map((function(t,e){var i=t.split(" ");return n[e]=i[1]&&"DESC"==i[1].toUpperCase()?-1:1,i[0]}));return n[0]=e?-1:1,this.sort((function(t,e){var a=0,o=function(t,e){var r=t[i[a]],s=e[i[a]];return r<s?-1*n[a]:r>s?1*n[a]:++a<i.length?o(t,e):0};return o(t,e)})),this},orderBy:function(e){var n=e;return t.isString(e)&&(n=function(t){return t[e]}),this.map((function(t){return t})).sort((function(t,e){var i=n(t),a=n(e);return i<a?-1:i>a?1:0}))},distinct:function(e){var n=e;t.isString(e)&&(n=function(t){return t[e]});var i=[];return this.forEach((function(t){var e=n(t);-1==i.indexOf(e)&&i.push(e)})),i},groupBy:function(e){var n=e;return t.isString(e)&&(n=function(t){return t[e]}),this.reduce((function(t,e){var i=n(e);return(t[i]=t[i]||[]).push(e),t}),{})},toDictionary:function(t,e){return this.reduce((function(n,i){return n[i[t]]=e?i[e]:i,n}),{})}})}(n),function(t){var e=[];t.Include=function(n){return new Promise(i=>{function a(){e.push(n.toLowerCase()),i()}if(e.indexOf(n.toLowerCase())>-1)i();else{var o=t.build("script",{type:"text/javascript"});o.readyState?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(o.onreadystatechange=null,a())}:o.onload=function(){a()},o.src=n,document.getElementsByTagName("head")[0].appendChild(o)}})}}(n),function(t){function e(t,n){return t.split(/\.|\[|\]/).reduce((function(t,n){if(""===n)return t;if("this"===n)return t;let i=n,a=n.indexOf("|")>-1,o=[];if(a){let t=String.trimValues(n.split("|"));i=t[0],o=String.trimValues(t[1].split(","))}let r=t[i];return void 0===r&&t.outerScope&&(r=e(i,t.outerScope)),null!=r?a?r.__proto__[o[0]].apply(r,o.slice(1)):r:t===self?"":self}),n||self)}function i(n,i,a){var o=function(t,n,o){var r=String.trimValues(n).reduce((function(t,n){return t.push("@"==n.charAt(0)?e(n.slice(1),i):n),t}),o);return a&&r.push(a),t.apply(i,r)};return n.replace(/{([^{]+)?}/g,(function(n,a){if(a.indexOf(":")>0){let t=String.trimValues(a.split(":")),n=e(t[0],i),[r,s]=String.trimValues(t[1].split(/=>/)),l=s?String.trimValues(s.split(/\s|\;/)):[];return o(e(r,i),l,[n])}let[r,s]=String.trimValues(a.split(/=>/));var l=e(r,i);return t.isFunction(l)?o(l,s.split(/\s|\;/),[]):l}))}function a(o,r){var s=t.$(o),l=t.$("[xfor]",s),c=l.reduce((e,n)=>e.concat(t.$("[xbind]",n)),[...l]),d=t.$("[xbind]",s).filter(t=>!c.includes(t));return s.attributes.xbind&&d.push(s),d.forEach((function(n){t.toArray(n.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach(t=>{t.textContent=i(t.textContent,r,t)}),String.trimValues(n.attributes.xbind.value.split(";")).forEach((function(i){if(""===i)return;let[a,o]=String.trimValues(i.split(":")),[s,l]=String.trimValues(o.split(/=>/));var c=e(s,r);if(t.isFunction(c)){var d=String.trimValues(l.split(/\s|#/)).reduce((function(t,n){return t.push("@"==n.charAt(0)?e(n.slice(1),r):n),t}),[]);d.push(n),c=c.apply(r,d)}a&&(n[a]=c)}))})),l.map(t=>{let[i,o]=String.trimValues(t.attributes.xfor.value.split(" in ")),s=e(o,r);return s&&s!=window&&s.map((e,o)=>{let s={index:o,outerScope:r};s[i]=n.clone(e);let l=a(t.cloneNode(!0),s);t.parentNode.insertBefore(l,t)}),t}).forEach(t=>t.parentNode.removeChild(t)),o}t.templates={getValue:e,merge:i,execute:function(e,n,i){var o=t.$(e),r=n.reduce((function(t,e,n){var r={index:n,data:e,node:a(o.cloneNode(!0),e)};return t.nodes.push(r),i||t.html.push(r.node.outerHTML.replace(/xbind="[^"]*"/g,"")),t}),{nodes:[],html:[]});return i?r.nodes:r.html.join("")},fill:a}}(n),function(t){t.ajax={},t.apply(t.ajax,{get:function(t,e){return new Promise((n,i)=>{var a=this.createXMLHttpRequest();a.open("GET",t,!0),e&&e(a),a.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),a.setRequestHeader("Cache-Control","no-cache"),a.onreadystatechange=function(){4==a.readyState&&n(a.responseText)},a.onerror=function(t){i(t)},a.send(null)})},post:function(t,e,n){return new Promise((i,a)=>{var o=this.createXMLHttpRequest();o.open("POST",t,!0),n?n(o):o.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset:ISO-8859-1"),o.onreadystatechange=function(){4==o.readyState&&i(o.responseText)},o.send(e)})},callWebMethod:function(t,e,n){var i=this.createXMLHttpRequest();i.open("POST",t,!0),i.onreadystatechange=function(){4==i.readyState&&n(i.responseText)},i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.send(e)},createXMLHttpRequest:function(){return new XMLHttpRequest}})}(n),function(t){var e;t.tabbly={execute:function(t){var n;e={sections:[],groups:[],details:[]};var i="",a="",o=!1;function r(t){return t&&t.trim().startsWith("@")?e[t.trim().split("@")[1].trim()]||"":t?t.trim():""}function s(t){for(var e=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,n={},i=e.exec(t);null!=i;)n[i[1].trim()]=r(i[2].trim().replace(/^'([^']*)'$/g,"$1")),i=e.exec(t);return n}return t.split("\n").forEach((function(t){!function(t,e){if(!i&&!t.trim())return function(){};var r;if(!/DEFINE|#|CREATE|SET|FUNCTION|END/.test(t)){if(i)return a+=e,a+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}if(/^#/.test(t))return function(){};if(/^SET (\w.*)/.test(t)){var l=t.match(/^SET (\w.*)$/);return o=!0,i=l[1].trim(),a="",function(){}}if(/^FUNCTION (\w.*)/.test(t)){var l=t.match(/^FUNCTION (\w.*)$/);return o=!1,i=l[1].trim(),a="",function(){}}if(/^END/.test(t)){var c=a,d=i;return i=a="",o?(o=!1,function(t){n[d]=c.trim()}):function(t){t[d]=new Function("ctx",c)}}if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(t)){l=t.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/);return r=l,function(t){t[r[1].trim()]=r[2].trim()}}if(!/^CREATE\s\s*(\w*) (.*)$/.test(t))throw new Error("Tabbly : Unrecognized text after DEFINE");return"section"==(l=t.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var t=l;return function(e){e.sections.push(s(t[2])),n=e.sections[e.sections.length-1]}}():"group"==l[1]?function(){var t=l;return function(e){e.groups.push(s(t[2])),n=e.groups[e.groups.length-1]}}():"detail"==l[1]?function(){var t=l;return function(e){e.details.push(s(t[2])),n=e.details[e.details.length-1]}}():void 0}(t.trim(),t)(e)})),{context:e}}}}(n),function(t){t.ReportEngine={},t.ReportEngine.generateReport=function(e,n,i){i.message({type:"report.begin"});var a=e||t.ReportEngine.rd,o=a.context.parseData?a.context.parseData(a,n,i.message):n;i.message({type:"report.log.message",text:"Inicializando..."}),console.time("Render");var r=function(e,n,a){i.send(t.templates.merge(e,n))};function s(){m.forEach((function(t,e){if(!(e<c))return i.message({type:"report.sections.group.header",value:t.id}),t.definition.header?r(t.definition.header,t):t.definition.headerValueProvider?i.send(t.definition.headerValueProvider(t)):void 0}))}function l(t){var e=m.map((function(t){return t}));t&&e.splice(0,t),e.reverse().forEach((function(t){return i.message({type:"report.sections.group.footer",value:t.id}),t.definition.footer?r(t.definition.footer,t):t.definition.footerValueProvider?i.send(t.definition.footerValueProvider(t)):void 0}))}var c=-1,d=function(){var t=JSON.parse(a.context.summary||"{}");return a.context.onInitSummaryObject?a.context.onInitSummaryObject(t):t}(),u=(a.context.sections||[]).where({type:"header"}),p=(a.context.sections||[]).where({type:"total"}),f=((a.context.sections||[]).where({type:"footer"}),a.context.details||[]),m=a.context.groups.map((function(e,n){return{name:"G"+(n+1),rd:a,definition:e,current:"",data:t.clone(d),init:function(e){var n=e[this.definition.key].toString(),i=self.BS[this.name];i.all[n]=i.all[n]||[],i.all[n].push(e),i.recordCount=1,!1!==this.__resume&&(this.__resume?t.ReportEngine.copy(e,this.data):(this.__resume=Object.keys(this.data).length>0)&&t.ReportEngine.copy(e,this.data))},sum:function(e){var n=e[this.definition.key].toString(),i=self.BS[this.name];i.all[n]=i.all[n]||[],i.all[n].push(e),i.recordCount+=1,!1!==this.__resume&&t.ReportEngine.sum(e,this.data)},test:function(t){return t[this.definition.key]==this.current}}}))||[];self.BS={reportDefinition:a,mediator:i},a.context.iteratefn&&(i.message({type:"report.log.message",text:"Inicializando elementos..."}),o.forEach(a.context.iteratefn)),a.context.orderBy&&(i.message({type:"report.log.message",text:"Ordenando datos..."}),o.sortBy(a.context.orderBy,!1)),self.BS={recordCount:0,G0:t.clone(d),dataSet:o,reportDefinition:a,mediator:i},m.forEach((function(t,e){t.current=o&&o[0]?o[0][t.definition.key]:"",self.BS[t.name]={recordCount:0,all:{}}})),a.context.onStartfn&&a.context.onStartfn(self.BS),[a.context.sections,a.context.details,a.context.groups].reduce((function(t,e){return t.concat(e)}),[]).map((function(e){e.valueProviderfn&&(e.valueProvider=t.templates.getValue(e.valueProviderfn,self),delete e.valueProviderfn),e.footerValueProviderfn&&(e.footerValueProvider=t.templates.getValue(e.footerValueProviderfn,self),delete e.footerValueProviderfn),e.headerValueProviderfn&&(e.headerValueProvider=t.templates.getValue(e.headerValueProviderfn,self),delete e.headerValueProviderfn)})),i.message({type:"report.render.rows"}),i.message({type:"report.log.message",text:"Generando informe..."}),u.forEach((function(t){return i.message({type:"report.sections.header",value:t}),t.template?r(t.template,t):t.valueProvider?i.send(t.valueProvider(t)):void 0})),o.length>0&&s(),o.forEach((function(e,n){if(self.BS.recordCount++,self.BS.isLastRow=o.length===self.BS.recordCount,self.BS.isLastRowInGroup=self.BS.isLastRow,self.BS.percent=self.BS.recordCount/o.length*100,self.BS.previous=self.BS.data||e,self.BS.data=e,m.forEach((function(t,e){self.BS[t.name].data=Object.create(t.data)})),t.ReportEngine.sum(e,self.BS.G0),a.context.onRowfn&&a.context.onRowfn(self.BS),i.message({type:"report.render.row",text:self.BS.percent.toFixed(1)+" %",value:self.BS.percent}),m.every((function(t){return t.test(e)}))?m.forEach((function(t){t.sum(e)})):(m.some((function(t,n){return!t.test(e)&&(l(c=n),m.forEach((function(t,i){i>=c?(t.init(e),c=n):t.sum(e)})),!0)})),m.forEach((function(t){t.current=e[t.definition.key]})),a.context.onGroupChangefn&&a.context.onGroupChangefn(self.BS),i.message({type:"report.sections.group.change",value:"__groups"}),s()),m.length&&!self.BS.isLastRow){var d=o[self.BS.recordCount];self.BS.isLastRowInGroup=!m.every((function(t){var e=t.definition.key;return d[e]===self.BS.data[e]}))}f.forEach((function(t){return i.message({type:"report.sections.detail",value:t.id}),t.template?r(t.template,t):t.valueProvider?i.send(t.valueProvider(t)):void 0}))})),o.length>0&&(self.BS.previous=self.BS.data,l()),p.forEach((function(t){return i.message({type:"report.sections.total",value:t.id}),t.template?r(t.template,t):t.valueProvider?i.send(t.valueProvider(t)):void 0})),i.message({type:"report.render.end"}),i.message({type:"report.end"}),i.flush(),console.timeEnd("Render")},t.ReportEngine.copy=function(t,e){Object.keys(e).map((function(n){e[n]=t[n]}))},t.ReportEngine.sum=function(t,e){Object.keys(e).map((function(n){e[n]+=t[n]}))},t.ReportEngine.compute=function(t,e){return t.reduce((function(t,n){return t+n[e]}),0)},t.ReportEngine.group=function(t,e){var n=t,i=function(t,a){return n.distinct((function(e){return e[t]})).forEach((function(i){e[i]=n.reduce((function(e,n,o,r){return n[t]==i?e+n[a]:e}),0)})),i};return i}}(n)}(i);var a=i.Pol;let o={},r=-1;var s={subscribe:function(t,e){o[t]||(o[t]=[]);var n=(++r).toString();return o[t].push({token:n,func:e}),n},publish:function(t,e){return!!o[t]&&(setTimeout((function(){for(var n=o[t],i=n?n.length:0;i--;)n[i].func(t,e)}),0),!0)},unsubscribe:function(t){for(var e in o)if(o[e])for(var n=0,i=o[e].length;n<i;n++)if(o[e][n].token===t)return o[e].splice(n,1),t;return!1},TOPICS:{VIEW_CHANGE:"view:change",VALUE_CHANGE:"value:change",MUNICIPIO_CHANGE:"municipio:change",WINDOW_SCROLL:"window.scroll",NOTIFICATION:"notification.show"}};const l="\n  <h1>{title}</h1>\n";const c="  \n  <p>{text}</p>\n";const d=s.TOPICS;var u=function(t){return{root:{},init:function(){},render:function(){return this.root=a.build("section",{id:"app-content-container",innerHTML:"",className:"w3-container",style:{minHeight:"440px",padding:"0 0 60px 0"}}),this.root},mounted:function(){!function(){function t(){var t=document.getElementById("appMenu");if(!t.className.includes("sticky")){var e=t.offsetTop;window.onscroll=function(){window.pageYOffset>=e?t.classList.add("sticky"):t.classList.remove("sticky"),s.publish(d.WINDOW_SCROLL,window)}}}window.addEventListener("resize",(e=t,n=150,function(){var t=this,o=arguments,r=function(){a=null,i||e.apply(t,o)},s=i&&!a;clearTimeout(a),a=setTimeout(r,n),s&&e.apply(t,o)}),!1),t();var e,n,i,a}()}}};const p=["[on-click]","[on-publish]","[route-link]","[on-change]"];var f={addEventListeners:function(t,e,n){let i={innerHTML:(t,e)=>t.innerHTML=e,className:(t,e)=>t.className=e};p.forEach((o,r)=>{a.toArray(a.$(o,t)).concat([t]).forEach(t=>{let l=o.replace("[","").replace("]","");if(!t.attributes[l])return;let c=t.attributes[l].value,d=c.split(":");if(0!==r){if(1===r){let o=a.templates.getValue(d[0],s);o=o===window?d[0]:o,s.subscribe(o,(o,r)=>{let s=d[1];if(s){let o=i[s]||e[s]||a.templates.getValue(s,n);o&&o.apply(n,[t,r])}else i.innerHTML(t,r)})}if(2===r&&(t.onclick=function(t){let e=n.router,i=e.normalizePath(t.target.href);if(e.current!=i)try{e.navigateTo(i)}catch(t){console.log(t)}return!1}),3===r){let i="SELECT"===t.tagName;if("publish"===c)return void(i?t.onchange=()=>s.publish(s.TOPICS.VALUE_CHANGE,t):t.oninput=()=>s.publish(s.TOPICS.VALUE_CHANGE,t));let o=e[c]||a.templates.getValue(c,n);i?t.onchange=()=>o.apply(n,[t]):t.oninput=()=>o.apply(n,[t])}}else{let i=e[d[0]]||a.templates.getValue(d[0],n);t.onclick=e=>{let o=d.slice(1).reduce((function(t,e){return t.push("@"==e.charAt(0)?a.templates.getValue(e.slice(1),n):e),t}),[t,e]);return i.apply(n,o)}}})})}};const m='  \n  <div class="w3-dropdown-click">\n    <button on-click="toggleMenu" class="w3-button w3-black"><i class="fa fa-bars"></i></button>\n    <div class="w3-dropdown-content w3-bar-block w3-card-4" style="z-index: 1002;">\n      <a href="templates" route-link on-click="hideMenu" class="w3-bar-item w3-button">Libros en <i>OpenLibra</i></a>\n      <a href="schedule" route-link on-click="hideMenu" class="w3-bar-item w3-button">Agenda</a>\n      <hr style="margin:0"/>\n      <a href="strava" route-link on-click="hideMenu" class="w3-bar-item w3-button">Strava</a>\n      <hr style="margin:0"/>\n      <a href="templates/get-value" route-link on-click="hideMenu" class="w3-bar-item w3-button">Templates</a>\n      <a href="templates/utils" route-link on-click="hideMenu" class="w3-bar-item w3-button">addEventListeners</a>\n    </div>\n  </div>\n  <a href=""          route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button selected">Inicio</a>\n  <a href="el-tiempo" route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">El tiempo</a>\n  <a href="list"      route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">Notas</a>\n  <a href="note"      route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button">+</a>\n  <a href="about"     route-link on-publish="TOPICS.VIEW_CHANGE:sync" class="w3-bar-item w3-button w3-right">?</a>\n  ';var h=function(t){let e,n={root:{},id:"menu.component.ref",init:function(){},render:function(){let t={id:"appMenu",innerHTML:m.format(this),className:"w3-bar w3-black"};return this.root=a.build("nav",t),this.root},mounted:function(){f.addEventListeners(n.root,n.eventHandlers,{router:t.router,toggleMenu:i,hideMenu:o})},eventHandlers:{sync:function(t,e){o(),e.name===t.href.split("/").lastItem()?t.classList.add("selected"):t.classList.remove("selected")}}};function i(t){e=t.nextElementSibling,e.classList.toggle("w3-show")}function o(t){e&&e.classList.remove("w3-show")}return n};var v=function(){return{root:{},init:function(){},render:function(){return this.root=a.build("div",'  \n  <div class="w3-container w3-center w3-animate-left" style="padding-top:60px;">\n    <img src="./assets/img/logo.png" alt="logo" style="width: 300px">\n    <p>La app que te permite almacenar todas tus notas en el móvil!!!</p>\n  </div>').firstElementChild,this.root},mounted:function(){},dispose:function(){}}};class w{constructor(t){this.dbname=t,this.db=""}openDb(){return new Promise((t,e)=>{let n=window.indexedDB.open(this.dbname,1);n.onsuccess=e=>{this.db=e.target.result,t(this.db)},n.onerror=t=>{e("Error")},n.onupgradeneeded=t=>{this.db=t.target.result;try{this.db.objectStoreNames&&this.db.objectStoreNames.contains("notas")&&this.db.deleteObjectStore("notas")}catch(t){console.log(t)}this.db.createObjectStore("notas",{keyPath:"key"})}})}readAll(t){return new Promise((e,n)=>{var i=[];this.db.transaction(t,"readonly").objectStore(t).openCursor(IDBKeyRange.lowerBound(0)).onsuccess=t=>{var n=t.target.result;n?(i.push(n.value),n.continue()):e(i)}})}save(t,e){return new Promise(n=>{var i;(i=this.db.transaction(t,"readwrite").objectStore(t).put(e)).onsuccess=t=>{n(e)},i.onerror=t=>{console.log(t)}})}delete(t,e){return new Promise(n=>{var i;(i=this.db.transaction(t,"readwrite").objectStore(t).delete(e)).onsuccess=t=>{n()},i.onerror=t=>{console.log(t)}})}readOne(t,e){return new Promise(n=>{var i;(i=this.db.transaction(t,"readwrite").objectStore(t).get(e)).onsuccess=t=>{n(t.target.result)},i.onerror=t=>{console.log(t)}})}}const b='\n<div class="w3-border-bottom w3-animate-left" style="padding:0; font-size:14px;" id="note-{note.key}">\n  <div class="w3-container" style="padding:5px">\n    <div on-click="expandCollapse"><b>{note.title}</b><i class="w3-right w3-large fa fa-caret-down"></i></div>\n  </div>\n  <div class="w3-container" style="display:none;padding:0 4px">\n    <p id="editp-{note.key}" on-click="editNote" style="padding:2px;min-height:4em;margin:2px 0;white-space: pre-wrap">{formatText:note.text}</p>\n    <div class="w3-bar w3-center" style="padding:4px 0;">\n      <button type="button" id="delete-{note.key}" on-click="deleteNote" class="w3-button w3-border"><i class="fa fa-trash" aria-hidden="true"></i></button>\n      <button type="button" id="fav-{note.key}" on-click="saveFavorites" class="w3-button w3-border"><i class="fa {css:@note.key}" aria-hidden="true"></i></button>\n      <button type="button" id="edit-{note.key}" on-click="editNote" class="w3-button w3-border"><i class="fa fa-edit" aria-hidden="true"></i></button>\n    </div>\n  </div>\n</div>';var g=function(t){let e,n,i=[],o=[],r={root:{},init:function(){},render:function(){return this.root=a.build("div",'\n<div notas-container style="padding:0; margin-bottom:43px;" class="w3-animate-left"></div>\n<button btn-add-note on-click="addNote" class="w3-button w3-black w3-circle">＋</button>'),n=this.root.firstElementChild,this.root},mounted:function(){e=new w("notas-app.db"),e.openDb().then(t=>{s()}),f.addEventListeners(r.root,r.eventHandlers)},eventHandlers:{addNote:function(e,n){t.router.navigateTo("note")},deleteNote:function(t,n){let a=parseInt(t.id.split("-")[1]),o=i.where({key:a})[0],r=document.getElementById("note-{0}".format(a));e.delete("notas",a).then(()=>{i.remove(o),r.parentNode.removeChild(r)})},expandCollapse:function(t,e){let n=t.parentNode.nextElementSibling.style;"none"==n.display?(n.display="",t.querySelector("i").classList.remove("fa-caret-down"),t.querySelector("i").classList.add("fa-caret-up")):(n.display="none",t.querySelector("i").classList.remove("fa-caret-up"),t.querySelector("i").classList.add("fa-caret-down"))},saveFavorites:function(t,e){let n=t.firstElementChild,i=t.id.split("-")[1];o.includes(i)?(o.remove(i),n.classList.add("fa-star-o"),n.classList.remove("fa-star")):(o.push(i),n.classList.remove("fa-star-o"),n.classList.add("fa-star"));window.localStorage.setItem("favorites",o.join("-"))},editNote:function(e,n){t.router.navigateTo("note/"+e.id.split("-")[1])}}};function s(){e.readAll("notas").then(t=>{i=t.reverse(),o=(window.localStorage.getItem("favorites")||"").split("-"),n.innerHTML="",i.map(t=>{let e={note:t,formatText:function(t){return t},css:function(t){return o.includes(t.toString())?"fa-star":"fa-star-o"}};return a.build("div",b.format(e))}).map(t=>t.firstElementChild).forEach(t=>{n.appendChild(t)}),f.addEventListeners(n,r.eventHandlers)})}return r};var y=function(){return{root:{},init:function(){},render:function(){return this.root=a.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-left">\n  <h1>Sobre Notas App</h1>\n  <p style="text-indent:1em;">\n    Notas App es una prueba de concepto de lo que podría ser un <span class="w3-bold w3-italic">framework</span> \n    sencillo con el cual desarrollar aplicaciones <span class="w3-bold w3-italic">SPA</span> basadas únicamente en <span class="w3-bold">HTML5</span> y <span class="w3-bold">JavaScript</span>.\n  </p>\n  <p style="text-indent:1em;">\n    Estas aplicaciones serían subceptibles de ser instaladas en dispositivos móviles como una <span class="w3-bold w3-italic">PWA</span>.\n  </p>\n  <ul class="w3-ul w3-border">\n    <li><h2>Referencias</h2></li>\n    <li><a href="https://es.wikipedia.org/wiki/Single-page_application" target="_blank">SPA (Single-page application)</a></li>\n    <li><a href="https://es.wikipedia.org/wiki/Progressive_Web_Apps" target="_blank">PWA (Progressive Web Apps)</a></li>\n    <li><h2>Repositorio</h2></li>\n    <li><a href="https://github.com/rcastrogo/notas-app" target="_blank">https://github.com/rcastrogo/notas-app</a></li>\n  </ul>\n  <p style="text-indent:1em;">\n    Para su desarrollo no se han utilizado ninguno de los <span class="w3-bold w3-italic">frameworks</span> existentes como pueden ser Angular, React o Vue.js.\n  </p>\n</div>\n<div class="w3-container w3-margin-bottom w3-center">\n  <button type="button" about-btn-back class="w3-button w3-black">Volver</button>\n</div>\n'),this.root},mounted:function(){this.root.querySelector("[about-btn-back]").onclick=()=>{history.back()}}}};const x=s.TOPICS;var k=function(t){let e,n,i={root:{},init:function(){},render:function(){return this.root=a.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-left">\n  <h2>Nueva nota</h2>\n  <form class="w3-margin-bottom">\n    <label for="txt-title">Título</label>\n    <input on-change="onChange" class="w3-input w3-border" type="text" id="txt-title" placeholder="Introduce un título" >\n    <label for="txt-text">Texto</label>\n    <textarea on-change="publish" class="w3-input w3-border" id="txt-text" rows="4" placeholder="Contenido de la nota"></textarea>\n  </form>\n  <div class="w3-container w3-margin-bottom w3-center w3-animate-zoom">\n    <button type="button" id="btn-grabar" class="w3-button w3-black">Grabar</button>\n  </div>\n</div>\n'),this.root},mounted:function(){!function(){let r=i.root.firstElementChild;r.style.display="none",f.addEventListeners(r,{},{onChange:function(t){}}),s.subscribe(x.VALUE_CHANGE,(function(t,e){})),n=new w("notas-app.db"),n.openDb().then(()=>{let s=function(){r.style.display="",a.$("btn-grabar").onclick=o},l=t.router.current.params[1]||"";l?n.readOne("notas",parseInt(l)).then(t=>{e=t,a.$("txt-title").value=e.title,a.$("txt-text").value=e.text,a.$("h2",i.root)[0].innerHTML="Edición de nota",s()}):s()})}()}};function o(){var i=a.$("txt-title"),o=a.$("txt-text"),r=i.value.trim(),l=o.value.trim();if(!r)return void setTimeout(()=>i.focus(),20);if(!l)return void setTimeout(()=>o.focus(),20);let c=new Date;n.save("notas",{key:e?e.key:c.valueOf(),date:e?e.date:"{0}/{1}/{2}".format(c.getDate(),c.getMonth(),c.getFullYear()),title:r,text:l}).then(n=>{t.router.navigateTo("list"),s.publish(x.NOTIFICATION,{message:e?"La nota se ha actualizado correctamente!!!":"La nota se ha insertado correctamente!!!"})})}return i};const S=s.TOPICS;var E=function(t){let e,n,i,o,r={root:{},data:{municipios:{45022:"Buenaventura (TOLEDO)",28079:"Madrid"}},init:function(){},render:function(){return this.root=a.build("div",'  \n<div class="w3-container w3-margin-bottom w3-animate-bottom">\n  <div class="w3-border w3-margin-top">\n    <button on-click="expandCollapse" class="w3-button w3-block w3-left-align">\n      <span on-publish="TOPICS.MUNICIPIO_CHANGE:innerHTML">Buenaventura</span><i class="w3-right w3-large fa fa-caret-down"></i>\n    </button>\n    <div class="w3-hide">\n      <ul class="w3-ul">\n        <li on-click="requestData" id="loc-45022">Buenaventura</li>\n        <li on-click="requestData" id="loc-28079">Madrid</li>\n      </ul>\n    </div>\n  </div>\n  <div class="w3-margin-top w3-hide" id="aemetApi-container" style="padding:0;">\n    <div id="progress-bar-container">\n      <div class="w3-center">Cargando datos desde la AEMET...</div>\n      <div class="w3-border">\n        <div id="progress-bar" class="w3-green" style="height:24px;width:0%"></div>\n      </div>\n    <div>\n  </div>\n</div>'),this.root},mounted:function(){e=a.$("aemetApi-container"),i=a.$("progress-bar"),n=a.$("progress-bar-container"),f.addEventListeners(r.root,r.eventHandlers,{css:(t,e)=>{console.log(t)}}),c()},dispose:function(){clearInterval(o)},eventHandlers:{expandCollapse:d,requestData:function(t,e){let n=t.parentNode.parentNode.previousElementSibling;l=t.id.split("-")[1],s.publish(S.MUNICIPIO_CHANGE,r.data.municipios[l]),d(n),c()}}};let l=45022;function c(){!function(){let t=0;i.style.width="{0}%".format(t),o&&clearInterval(o),o=setInterval(()=>{t=(t+9)%100,i.style.width="{0}%".format(t)},300)}(),e.innerHTML="",e.appendChild(n),e.classList.remove("w3-hide");const r="https://opendata.aemet.es/opendata/api/prediccion/especifica/municipio/horaria/"+l+"?api_key=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyY2FzdHJvZ29AaG90bWFpbC5jb20iLCJqdGkiOiJmZmI3OWJjZi1lZWQwLTQwODMtYTkwZC04MmNkMmRhMTA2MjQiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTU4MjcyNTg3NiwidXNlcklkIjoiZmZiNzliY2YtZWVkMC00MDgzLWE5MGQtODJjZDJkYTEwNjI0Iiwicm9sZSI6IiJ9.bPhAJDutP62_75peo3qr88Qs1JQ4jmu6TWXHjvIzZx0";a.ajax.get(r,t=>{t.setRequestHeader("Accept","application/javascript")}).then(t=>JSON.parse(t)).then(t=>{if(200==t.estado)return a.ajax.get(t.datos);throw new Error(t.descripcion)}).then(n=>{var i;clearInterval(o),e.innerHTML="",(i=function(){const t='\n  <div class="w3-container w3-teal w3-center w3-small w3-padding">\n    {elaborado:fn.formatFecha=>time}\n  </div>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{prediccion.dia[0].fecha:fn.formatFecha => day}</h3>\n    <div>{fn.showDay:@rows-0}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[0].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[0].ocaso}</div>\n    </div>\n  </div>\n  <br/>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{fn.formatFecha:@prediccion.dia[1].fecha day}</h3>\n    <div>{fn.showDay:@rows-1}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[1].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[1].ocaso}</div> \n    </div>\n  </div>\n  <br/>\n  <div style="padding:0">\n    <h3 class="w3-center w3-border-bottom">{fn.formatFecha:@prediccion.dia[2].fecha day}</h3>\n    <div>{fn.showDay:@rows-2}</div>\n    <div class="w3-small w3-teal w3-padding w3-center">\n      <div><i class="fa fa-arrow-up"></i> {prediccion.dia[2].orto}</div>\n      <div><i class="fa fa-arrow-down"></i> {prediccion.dia[2].ocaso}</div>\n    </div>\n  </div>';let e={formatFecha:function(t,e){let n=t.split("T");if(e&&"date"===e)return n[0];if(e&&"time"===e)return n[1];if(e&&"day"===e){n=n[0].split("-");let t=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sabado"],e=new Date(~~n[0],~~n[1]-1,~~n[2]).getDay();return"{0} {1}".format(t[e],~~n[2])}return"{1} - {0}".format(...n)},showDay:function(t){return t.reduce((function(t,n){let i='\n          <tr class="w3-center">\n            <td>{row.periodo}:00</td>\n            <td>{row.cielo}</td>\n            <td>{row.temperatura}</td>\n            <td>{fn.formatZero:@row.lluvia}</td>\n            <td><i class="fa fa-2x fa-long-arrow-right pol-{row.viento[0]}"></i> {row.viento[1]}</td>\n          </tr>',a={row:n,fn:e};return t.append(i.format(a))}),a.stringBuilder().append('<table class="w3-table w3-bordered w3-small w3-striped">').append('<tr class="w3-center w3-teal"><th>Hora</th><th>Cielo</th><th>Temp<br>ºC</th><th>Lluvia<br>mm</th><th>Viento<br>km/h</th></tr>')).append("</table>").value},formatZero:function(t){return"0"==t?"":t}};return{root:{},init:function(){},render:function(){return this.root=a.build("div",t.format(this.data)),this.root},mounted:function(){},withData:function(t){let n=(i=new Date,"{0|paddingLeft,0000}-{1|paddingLeft,00}-{2|paddingLeft,00}-{3|paddingLeft,00}".format(""+i.getFullYear(),""+(i.getMonth()+1),""+i.getDate(),""+i.getHours()));var i;return this.data=JSON.parse(t)[0],this.data.fn=e,this.data.prediccion.dia.reduce((function(t,e,i){let a=e.fecha.fixDate("T"),o=[].concat(e.estadoCielo.map((function(t){return{t:"c",periodo:t.periodo,value:t.descripcion}})),e.temperatura.map((function(t){return{t:"t",periodo:t.periodo,value:t.value}})),e.precipitacion.map((function(t){return{t:"p",periodo:t.periodo,value:t.value}})),e.vientoAndRachaMax.where(t=>t.velocidad).map((function(t){return{t:"v",periodo:t.periodo,value:[t.direccion[0],t.velocidad[0]]}}))).where(t=>"{0}-{1}".format(a,t.periodo)>=n).groupBy("periodo");return t["rows-{0}".format(i)]=Object.keys(o).reduce((function(t,e){let n=o[e];return t.push({periodo:e,cielo:n.where({t:"c"})[0].value,temperatura:n.where({t:"t"})[0].value,lluvia:n.where({t:"p"})[0].value,viento:n.where({t:"v"})[0].value}),t}),[]).sortBy("periodo"),t}),this.data),this}}}().withData(n)).init(t),e.appendChild(i.render()),i.mounted(t)}).catch(t=>{clearInterval(o),console.log(t)})}function d(t,e){let n=t.nextElementSibling.classList;n.contains("w3-hide")?(n.remove("w3-hide"),t.querySelector("i").classList.remove("fa-caret-down"),t.querySelector("i").classList.add("fa-caret-up")):(n.add("w3-hide"),t.querySelector("i").classList.remove("fa-caret-up"),t.querySelector("i").classList.add("fa-caret-down"))}return r};const I=s.TOPICS;let _=function(t){let e,n,i,o;function r(t){n.where(e=>""===e.src&&e.offsetTop-800<t).map(t=>t.src=t.id)}function l(i){e.innerHTML='\n    <div class="w3-card-4 w3-margin-top w3-margin-bottom w3-center">\n      <header class="w3-container w3-light-grey">\n        <h1>Libros</h1>\n      </header>\n      <div id="progress-bar-container">\n        <div id="progress-bar" class="w3-green" style="height:10px;width:22%"></div>\n      <div>\n    </div>',function(){let t=a.$("progress-bar"),e=0;t.style.width="{0}%".format(e),o&&clearInterval(o),o=setInterval(()=>{e=(e+9)%100,t.style.width="{0}%".format(e)},300)}(),a.ajax.get("./assets/js/libros.json",t=>{t.setRequestHeader("Accept","application/javascript")}).then(t=>JSON.parse(t)).then(t=>t.where("cat"===i.tipo?function(t){return t.categories.where({nicename:i.id}).length}:function(t){return t.tags.where({nicename:i.id}).length}).slice(0,Math.min(t.length,25)).sortBy("title")).then(i=>{e.innerHTML="";let o=i.groupBy((function(t){return t.title[0].toUpperCase()}));i.bookmarks=Object.keys(o).reduce((function(t,e){return t.keys[e]?t:(t.keys[e]=o[e],t.rows.push({letra:e,id:t.keys[e][0].ID}),t)}),{keys:{},rows:[]}).rows,function(n){let i=a.build("div",'\n      <div class="w3-card-4 w3-margin-top w3-margin-bottom w3-center">\n        <header class="w3-container w3-light-grey" id="rafa">\n          <h1>Libros</h1>\n        </header>\n        <span xbind="" class="w3-small">{length:fn.formatId2} Elementos</span>\n        <div class="w3-light-grey w3-tiny" style="overflow:auto;width:100%">    \n          <div book-cat xfor="bookmark in bookmarks" class="w3-cell" >\n            <p xbind="id:bookmark.id" on-click="goToBookmark" class="w3-border w3-round w3-white" style="padding:2px 6px;margin:2px 4px;white-space:nowrap;">{bookmark.letra}</p>\n          </div>\n        </div>\n      </div>\n      <div xfor="libro in this" class="w3-card-4 w3-margin-bottom" xbind="id:fn.formatId => @libro.ID mark">\n        <header class="w3-container w3-light-grey" on-click="expandCollapse">\n          <h4 xbind="">{libro.title}</h4>\n        </header>\n        <div class="w3-container" style="transition: max-height .31s; overflow: hidden; max-height:500px">\n\n          <div xbind="" class="w3-container" style="padding:3px 0">\n            <img xbind="id:libro.thumbnail;tag:index" alt="Portada" on-click="showImage" class="book w3-left w3-margin-right w3-margin-bottom">\n            <b>Autor</b> {libro.author}<br/>\n            <b>Páginas</b> {libro.pages}<br/>\n            <b>Año</b> {libro.publisher_date}<br/>\n            <b>Editorial</b> {libro.publisher}<br/>\n            <b>Idioma</b> {libro.language}\n            <div xbind="id:fn.formatId => @libro.ID book;innerHTML:libro.content_short|htmlDecode" \n                 on-click="showAllContent" \n                 style="clear:both;margin-block-start: 0; font-style: oblique;font-family: monospace;">\n            </div>\n          </div>\n\n          <div class="w3-small" xbind="">Categorías ({libro.categories.length})</div>\n          <div class="w3-border w3-light-grey w3-small w3-round" style="overflow:auto;width:100%">\n            <div book-cat xfor="categoria in libro.categories" class="w3-cell">\n              <p xbind="id:categoria.nicename;innerHTML:categoria.name" on-click="makeRequest:cat" class="w3-border w3-round w3-white" style="padding:6px;margin:6px;white-space:nowrap;"></p>\n            </div>\n          </div>\n\n          <div class="w3-small" xbind="">Etiquetas ({libro.tags.length})</div>\n          <div class="w3-border w3-light-grey w3-small w3-round w3-margin-bottom" style="overflow:auto;width:100%">\n            <div book-cat xfor="etiqueta in libro.tags" class="w3-cell">\n              <p xbind="id:etiqueta.nicename;innerHTML:etiqueta.name" on-click="makeRequest:tag" class="w3-border w3-round w3-white" style="padding:6px;margin:6px;white-space:nowrap;"></p>\n            </div>\n          </div>\n        </div>\n      </div>\n      <button btn-add-note on-click="goTop" class="w3-button w3-black w3-circle">^</button>\n    ');n.fn={formatId:function(t,e,n){return"{0}-{1}".format(e,t)},htmlDecode:function(t){return t.htmlDecode()},formatId2:function(t,e,n,i){return t}};let o=n.toDictionary("ID");e.appendChild(a.templates.fill(i,n)),f.addEventListeners(e,{},{showAllContent:(t,e)=>{t.onclick=void 0;let n=t.id.split("-")[1];t.innerHTML=o[n].content.htmlDecode();let i=t.parentNode.parentNode;i.style.maxHeight="{0}px".format(i.scrollHeight)},makeRequest:function(t,e,n){l({tipo:n,id:t.id})},expandCollapse:function(t,e){let n=t.nextElementSibling.style,i="{0}px".format(t.nextElementSibling.scrollHeight);"500px"==n.maxHeight?n.maxHeight="0px":n.maxHeight!=i?n.maxHeight=i:n.maxHeight="0px"},goTop:()=>{t.components[0].root.scrollIntoView()},goTo:function(t,e,n){e.preventDefault(),a.$(n).scrollIntoView({behavior:"smooth",block:"end"})},goToBookmark:function(t,e){e.preventDefault(),a.$("mark-{0}".format(t.id)).scrollIntoView({behavior:"smooth",block:"end"})},showImage:function(e){t.router.navigateTo("images/{0}".format(n[e.tag].ID))}})}(i),n=a.$("img",e),r(0)}).catch(t=>{console.log(t)}).finally(()=>{clearInterval(o)})}return{root:{},data:{},init:function(){},render:function(){return this.root=a.build("div",'\n  <div class="w3-container w3-margin-bottom w3-animate-left">\n  </div>',"firstElementChild"),e=this.root,this.root},mounted:function(){l({tipo:"cat",id:"libros_programacion"}),i=s.subscribe(I.WINDOW_SCROLL,(t,e)=>{r(e.scrollY)})},dispose:function(){clearInterval(o),s.unsubscribe(i)},eventHandlers:{}}},T=function(t){return{root:{},data:{},init:function(t){},render:function(t){return this.root=a.build("div",'\n  <div class="w3-container w3-margin-bottom w3-animate-left">\n    <h1>Templates</h1>\n    <p style="text-indent:1em;">\n      Documentación sobre los métodos y los parámetros utilizados en la plantillas.\n    </p>\n    <h3>getValue</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">getValue</span> permite obtener el valor de un objeto por medio de una cadena de texto.\n      El valor recuperado puede ser a su vez un objeto o una función.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'window.location\');\n    </div>\n    <p style="text-indent:1em;">\n      Se pueden obtener valores de elementos específicos de un array.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'window.location.hostname[0]\');\n    </div>\n    <p style="text-indent:1em;">\n      Al valor se le puede aplicar cualquier función de su prototipo así como especificar los parámetros si es que son requeridos.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'location.host|toUpperCase\');\n      <br/>\n      getValue(\'location.host.length|toFixed,3\');\n    </div>\n    <p style="text-indent:1em;">\n      Se puede especificar el ámbito  o contexto en el que se relizará la búsqueda.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'id|toFixed,3\', { id : 5 })\');\n    </div>\n    <p style="text-indent:1em;">\n      Se puede utlizar la palabra <i>this</i> para acceder al ámbito o contexto asociado.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'this\', { id : 5 })\');\n    </div>\n    <p style="text-indent:1em;">\n      En el caso de no existir el valor en el ámbito actual se intentará encontrar en un ámbito asociado si es que existe.\n      Para ello se comprueba que existe la propiedad <i>outerScope</i> que sera el ámbito de búsqueda.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      getValue(\'id\', { items : [1,2,3] , outerScope : { id : 5 }})\');\n    </div>\n    <h3>merge</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">merge</span> permite aplicar los valores de un objeto a una plantilla de texto.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      merge(\'Url: {window.location.href}\');<br>\n      merge(\'Id: {id}\', { id : 5 });\n    </div>\n    <p style="text-indent:1em;">\n      Para determinar los valores de reemplazo se utiliza el método <span class="w3-bold w3-italic">getValue</span>.\n      Es por tanto válido el uso de la sintaxis:\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      merge(\'Nombre: {nombre|toUpperCase}\', { nombre : \'Nombre\' });<br>\n      merge(\'Id: {id|toFixed,2}\', { id : 5 });\n    </div>\n    <p style="text-indent:1em;">\n      Si el valor indicado es una función, esta será invocada con el ámbito o contexto actual y \n      el valor devuelto será el utilizado a la hora de realizar la transformación.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      merge(\'Id: {format=>a b|toLowerCase;c}\', { id : 5 , format : function(a,b,c){ return this.id; } });\n    </div>\n    <p style="text-indent:1em;">\n      Es posible especificar una función de transformación. Se utiliza el caracter ":" como separador.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      merge(\'{tag:format}\', { tag : \'DIV\', format : function(s){ return \'Tag: \' + s.toLowerCase(); } });<br>\n      merge(\'{tag|trim:format=>a @tag|toLowerCase;c}\', { tag : \'DIV   \', format : function(value,a,b,c){ return \'Tag: \' + value; } });<br>\n      merge(\'{tag|startsWith,D:format}\', { tag : \'DIV\', format : function(s){ return \'Tag: \' + s; } });<br>\n    </div>\n    <h3>string.format</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">format</span> permite reemplazar lo valores de una cadena de texto.\n      La sintaxis es muy similar a el método <span class="w3-bold w3-italic">merge</span> aunque existen algunas diferencias entre ambos.\n    </p>\n    <p style="text-indent:1em;">\n      La principal diferencia radica en que <span class="w3-bold w3-italic">format</span> acepta un número indeterminado de parámetros de entrada.\n      Estos parámetros pueden ser referenciados en la plantilla por medio de su indice:\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      \'{0} - {1}\'.format(55, \'Nombre\');\n    </div>\n    <p style="text-indent:1em;">\n      El último parámetro proporcionado será tomado como el ámbito o contexto a la hora resolver referencias:\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      \'{0} - {nombre}\'.format(55, { nombre : \'Antonio\' });\n    </div>\n    <p style="text-indent:1em;">\n      Resumen de las posibles formas de uso:\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      \'{0|toFixed,2}\'.format(55);<br/>\n      \'{0|toUpperCase}\'.format(\'aaa\');<br/>\n      \'{0|toUpperCase:format}\'.format(\'aaa\', { format(value){ return \'->\' + value; } });<br/>\n      \'{0:format}\'.format(\'aaa\', { format(value){ return \'->\' + value; } });<br/>\n      \'{0:format=>1;2}\'.format(\'aaa\', { format(value,a,b){ return \'->\' + value + a + b; } });<br/>\n      \'{format}\'.format({ id : 55, format(){ return this.id; }});<br/>\n      \'{format:url;@window.location.href|toUpperCase b}\'.format({ format(value, href, b){ return value + \' \' + href;}});<br/>\n      \'{id}\'.format({ id : 55, format(){ return this.id; }});<br/>\n      \'{id|toFixed,3}\'.format({ id : 55 });<br/>\n      \'{id|toFixed,3:format}\'.format({ id : 55, format(v){ return v + \' €\'; }});<br/>\n      \'{id:format=>@window.location.href|toUpperCase;b;c}\'.format({ id : 55, format(v,a,b,c){ return v + \' €\'; }});<br/>\n    </div>\n    <h3>execute</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">execute</span> permite aplicar a una plantilla (<span class="w3-bold w3-italic">HTMLElement</span>) los valores de todos y cada uno de los elementos de un array.\n    </p>\n    <p style="text-indent:1em;">\n      El valor devuelto puede ser o una cadena de texto para establecer la propiedad <span class="w3-bold w3-italic">innerHTML</span> o \n      un array de <span class="w3-bold w3-italic">HTMLElement</span> para añadirlos con el método <span class="w3-bold w3-italic">appendChild</span>.\n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      execute(HTMLElement|id, values, dom[true|false]);\n    </div>\n    <h3>fill</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">fill</span> permite aplicar los valores de un ámbito o contexto una plantilla (<span class="w3-bold w3-italic">HTMLElement</span>).\n    </p>\n    <p style="text-indent:1em;">\n      El valor devuelto es la propia plantilla en la que se han establecido los valores especificados. \n    </p>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      fill(HTMLElement|id, scope);\n    </div>\n    <p style="text-indent:1em;">\n      Formas de modificar/crear contenido:\n      <ul>\n        <li>xbind</li>\n        <li>templates.merge</li>\n        <li>xfor</li>\n      </ul>\n    </p>\n    <h5>Plantilla:</h5>\n    <div class="w3-code htmlHigh" style="overflow: auto;white-space: pre;">\n&lt;header&gt;\n  &lt;h1&gt;Libros&lt;/h1&gt;\n&lt;/header&gt;\n&lt;span <b>xbind=&quot;&quot;</b>&gt;<b>{length:fn.formatId2}</b> Elementos&lt;/span&gt;\n&lt;div&gt;    \n  &lt;div <b>xfor=&quot;bookmark in bookmarks&quot;</b>&gt;\n    &lt;p <b>xbind=&quot;id:bookmark.id&quot;</b> on-click=&quot;goToBookmark&quot;&gt;<b>{bookmark.letra}</b>&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;<b>xfor=&quot;libro in this&quot;</b> <b>xbind=&quot;id:fn.formatId =&gt; @libro.ID mark&quot</b>;&gt;\n  &lt;header on-click=&quot;expandCollapse&quot;&gt;\n    &lt;h4 <b>xbind=&quot;&quot;</b>&gt;<b>{libro.title}</b>&lt;/h4&gt;\n  &lt;/header&gt;\n  &lt;div&gt;\n    &lt;div <b>xbind=&quot;&quot;</b>&gt;\n      &lt;img <b>xbind=&quot;id:libro.thumbnail&quot;</b>&gt;\n      &lt;b&gt;Autor&lt;/b&gt; <b>{libro.author}</b>&lt;br/&gt;\n      &lt;b&gt;P&#225;ginas&lt;/b&gt; <b>{libro.pages}</b>&lt;br/&gt;\n      &lt;b&gt;A&#241;o&lt;/b&gt; <b>{libro.publisher_date}</b>&lt;br/&gt;\n      &lt;b&gt;Editorial&lt;/b&gt; <b>{libro.publisher}</b>&lt;br/&gt;\n      &lt;b&gt;Idioma&lt;/b&gt; <b>{libro.language}</b>\n      &lt;div <b>xbind=&quot;id:fn.formatId =&gt; @libro.ID book;innerHTML:libro.content_short|htmlDecode&quot;</b> on-click=&quot;showAllContent&quot;&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div <b>xbind=&quot;&quot;</b>&gt;Categor&#237;as (<b>{libro.categories.length}</b>)&lt;/div&gt;\n    &lt;div&gt;\n      &lt;div <b>xfor=&quot;categoria in libro.categories&quot;</b>&gt;\n        &lt;p <b>xbind=&quot;id:categoria.nicename;innerHTML:categoria.name&quot;</b> on-click=&quot;makeRequest:cat&quot;&gt;&lt;/p&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n    </div>\n\n    <h5>Datos:</h5>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: pre;">\n[\n  {\n    "ID": "17003",\n    "title": "Book of Scratch Vol. 1",\n    "author": "Varios",\n    "content": "The first ever Code Club bo...",\n    "content_short": "The first ever Code Club book...",\n    "publisher": "Raspberry Pi Press",\n    "publisher_date": "2018",\n    "pages": "111",\n    "language": "english",\n    "url_details": "http://www.etnassoft.com/biblioteca/book-of-scratch-vol-1/",\n    "url_download": "https://openlibra.com/book/book-of-scratch-vol-1",\n    "cover": "https://olcovers2.blob.core.windows.net/coverswp/2018/12/CC_Book_of_Scratch_v1-OpenLibra-339x461.gif",\n    "thumbnail": "https://olcovers2.blob.core.windows.net/coverswp/2018/12/CC_Book_of_Scratch_v1-OpenLibra-110x153.gif",\n    "categories": [\n      {\n        "category_id": 224,\n        "name": "Otros Lenguajes",\n        "nicename": "programacion_otros_lenguajes"\n      },\n      {\n        "category_id": 220,\n        "name": "Programación",\n        "nicename": "libros_programacion"\n      }\n    ]\n  }\n]\n    </div>\n\n    <h3>xbind</h3>\n    <p style="text-indent:1em;">\n      El atributo <span class="w3-bold w3-italic">xbind</span> permite determinar que elementos <span class="w3-bold w3-italic">HTMLElement</span>\n      serán procesados y en los que se reliazará la sustitución.\n    </p>\n    <p style="text-indent:1em;">\n      El contenido de este atributo es una lista de pares (propiedad:valor|función) separados por el caracter ";".\n      El valor obtenido es asignado a la propiedad correspondiente del <span class="w3-bold w3-italic">HTMLElement</span>.\n    </p>\n    <p style="text-indent:1em;">\n      Si el valor obtenido fuera una función, esta se invocará para obtener el valor de reemplazo. La función se ejecuta en el ámbito o\n      contexto altual y se le pasan los parámetros indicados después de "=>". Estos parámetros son procesados por el método <span class="w3-bold w3-italic">getValue</span>\n      si empiezan por "@".\n    </p>\n    <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n      &lt;img xbind=&quot;id:libro.thumbnail&quot;&gt;<br/>\n      &lt;p xbind=&quot;id:categoria.nicename;innerHTML:categoria.name&quot;&gt;&lt;/p&gt;<br/>\n      &lt;div xbind=&quot;innerHTML:libro.content_short|trim&quot;&gt; &lt;/div&gt;<br/>\n      &lt;xfor=&quot;libro in this&quot; xbind=&quot;id:fn.formatId =&gt; @libro.ID mark&quot;;&gt;<br/>\n      &nbsp&nbsp&lt;div xbind=&quot;&quot;&gt;<br/>\n      &nbsp&nbsp&nbsp&nbspCategor&#237;as ({libro.categories.length})<br/>\n      &nbsp&nbsp&lt;/div&gt;<br/>\n      &lt;/div&gt;\n    </div>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      data.fn = {<br/>\n      &nbsp&nbsp  formatId: function (id, prefix, element) {<br/>\n      &nbsp&nbsp&nbsp&nbsp    return \'{0}-{1}\'.format(prefix, id);<br/>\n      &nbsp&nbsp  }<br/>\n      }\n    </div>\n  </div>'),this.root},mounted:function(t){a.Include("https://www.w3schools.com/lib/w3codecolor.js").then(()=>w3CodeColor())},dispose:function(){},eventHandlers:{}}},C=function(t){return{root:{},data:{},init:function(t){},render:function(t){return this.root=a.build("div",'\n  <div class="w3-container w3-margin-bottom w3-animate-left">\n    <h1>Utils</h1>\n    <p style="text-indent:1em;">\n      Documentación sobre los métodos y los parámetros utilizados para la asociación de eventos de forma declarativa.\n    </p>\n    <h3>addEventListeners</h3>\n    <p style="text-indent:1em;">\n      El método <span class="w3-bold w3-italic">addEventListeners</span> permite realizar la asociación de una serie de\n      eventos de una forma declarativa.\n    </p>\n    <p style="text-indent:1em;">\n      Los eventos disponibles son:\n      <ul>\n        <li>on-click</li>\n        <li>on-publish</li>\n        <li>route-link</li>\n        <li>on-change</li>\n      </ul>\n    </p>\n    <p style="text-indent:1em;">\n      El método tiene la siguiente firma;\n      <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n        addEventListeners(container, handlers, context);<br>\n        <br>\n        utils.addEventListeners(<br>component.root, \n                                <br>component.eventHandlers, { \n                                <br>&nbsp router      : component.router,\n                                <br>&nbsp toggleMenu  : toggleMenu,\n                                <br>&nbsp hideMenu    : hideMenu\n                                <br>});\n      </div>\n      <i>Container</i> es el <span class="w3-bold w3-italic">HTMLElement</span> raíz en el que se realizará el enlace.\n      <i>Handlers</i> y <i>context</i> son objetos en los que residen las funciones referenciadas. La búsqueda se realiza en el orden indicado.\n      Si la función no existe en <i>handlers</i> se busca en <i>context</i>.\n    </p>\n    <h4>on-click</h4>\n    <p style="text-indent:1em;">\n      El atributo <span class="w3-bold w3-italic">on-click</span> permite asociar el evento click de un elemento con una función.\n      La función se ejecutará en el contexto proporcionado. Es posible pasar parámetros adicionales a la función. Los parámetros \n      se separan por el caracter ":".\n      <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n        &lt;button on-click=&quot;addNote:1:@id&quot;&gt;＋&lt;/button&gt;<br>\n      </div>\n      <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n        function addNote(target, mouseEvent, 1, 55);\n      </div>\n    </p>\n    <h4>on-publish</h4>\n    <p style="text-indent:1em;">\n      El atributo <span class="w3-bold w3-italic">on-publish</span> permite realizar la \n      subcripción a una determinada publicación o mensaje y asociarla con una función encargada de su proceso.\n      La función se ejecutará en el contexto proporcionado.\n      <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n        &lt;a href=&quot;&quot; route-link on-publish=&quot;TOPICS.VIEW_CHANGE:syncMenuItem&quot;&gt;Inicio&lt;/a&gt;<br>\n      </div>\n      <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n        function syncMenuItem(target, data){\n          <br>&nbsp hideMenu();\n        <br>}\n      </div>\n      Existen dos funciones para realizar el cambio de algunos valores.\n      <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n        &lt;span on-publish=&quot;TOPICS.XXX_CHANGE:innerHTML&quot;&gt;Madrid&lt;/span&gt;\n      </div>\n      <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n        <br>let fn = {\n        <br>&nbsp innerHTML : (e, value) => e.innerHTML = value,\n        <br>&nbsp className : (e, value) => e.className = value\n        <br>}\n      </div>\n    </p>\n    <h4>route-link</h4>\n    <p style="text-indent:1em;">\n      El atributo <span class="w3-bold w3-italic">route-link</span> permite asociar el evento click de un \n      <span class="w3-bold w3-italic">HTMLAnchorElement</span> con una función que automáticamente cambiará la ruta\n      actual a la establecida en su propiedad href. El atributo no tiene parámetros.\n      <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n        &lt;a href=&quot;templates/utils&quot; route-link on-click=&quot;hideMenu&quot;&gt;Utils&lt;/a&gt;<br>\n        &lt;a href=&quot;about&quot; route-link on-publish=&quot;TOPICS.VIEW_CHANGE:sync&quot;&gt;?&lt;/a&gt;\n      </div>\n    </p>\n    <p style="text-indent:1em;">\n      Es necesario proporcionar una referencia a router en el contexto en la llamada..\n      <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n        utils.addEventListeners(<br>&nbsp component.root, \n                                <br>&nbsp component.eventHandlers,\n                                <br>&nbsp { \n                                <br>&nbsp&nbsp router      : component.router,\n                                <br>&nbsp&nbsp toggleMenu  : toggleMenu,\n                                <br>&nbsp&nbsp hideMenu    : hideMenu\n                                <br>&nbsp });\n      </div>\n    </p>\n    <h4>on-change</h4>\n    <p style="text-indent:1em;">\n      El atributo <span class="w3-bold w3-italic">on-change</span> permite controlar el cambio de los valores en \n      los elementos <span class="w3-bold w3-italic">HTMLInputElement</span> y <span class="w3-bold w3-italic">HTMLSelectElement</span>.\n      El valor del atributo puede ser una función o \'publish\'. En el primer caso la función especificada recibe las notificaciones.\n      La función se ejecutará en el contexto proporcionado.\n      En el segundo caso automaticamente se creará un publicador de mensajes de cambio.\n    </p>\n    <div class="w3-code htmlHigh" style="overflow: auto;white-space: nowrap;">\n      &lt;h2&gt;Nueva nota&lt;/h2&gt;<br>\n      &lt;form&gt;<br>\n        &nbsp &lt;label for=&quot;txt-title&quot;&gt;T&#237;tulo&lt;/label&gt;<br>\n        &nbsp &lt;input on-change=&quot;onChange&quot; type=&quot;text&quot; id=&quot;txt-title&quot; &gt;<br>\n        &nbsp &lt;label for=&quot;txt-text&quot;&gt;Texto&lt;/label&gt;<br>\n        &nbsp &lt;textarea on-change=&quot;publish&quot; id=&quot;txt-text&quot; rows=&quot;4&quot;&gt;&lt;/textarea&gt;<br>\n      &lt;/form&gt;<br>\n      &lt;div&gt;<br>\n        &nbsp &lt;button type=&quot;button&quot; id=&quot;btn-grabar&quot;&gt;Grabar&lt;/button&gt;<br>\n      &lt;/div&gt;<br>\n    </div>\n    <div class="w3-code jsHigh" style="overflow: auto;white-space: nowrap;">\n      utils.addEventListeners(__container, {}, {\n      <br>&nbsp onChange: (e) => {\n      <br>&nbsp&nbsp   console.log(\'onChange_fn\', e.value);\n      <br>&nbsp }\n      <br>&nbsp });\n      <br>&nbsp pubsub.subscribe(TOPICS.VALUE_CHANGE, (message, e) => {\n      <br>&nbsp&nbsp   console.log(\'value.change\', e.value);\n      <br>&nbsp })\n    </div>\n\n\n  </div>'),this.root},mounted:function(t){a.Include("https://www.w3schools.com/lib/w3codecolor.js").then(()=>w3CodeColor())},dispose:function(){},eventHandlers:{}}};var L=n(0),H=n.n(L),q=function(t){let e={root:{},init:function(){},render:function(){return this.root=a.build("div",H.a,"firstElementChild"),t=this.root,f.addEventListeners(t,{goBack:()=>{history.back()}}),t;var t},addButton:t=>{e.root.firstElementChild.appendChild(t)}};return e},A=n(1),M=n.n(A);const O=s.TOPICS;var j=function(t){let e=q(),n={};return{root:{},init:function(){},render:function(){var t;return this.root=e.render(),n=a.build("div",M.a,"firstElementChild"),this.root.appendChild((t=n,f.addEventListeners(t,{notify:()=>{s.publish(O.NOTIFICATION,{message:"Imagen mostrada"})}}),t)),this.root},mounted:function(){s.publish("msg\\page_component\\update\\title","Imagen"),a.ajax.get("./assets/js/libros.json",t=>{t.setRequestHeader("Accept","application/javascript")}).then(e=>{let i=JSON.parse(e),a=t.router.current.params[1],o=i.where({ID:a})[0].cover;n.style.backgroundImage="url({0})".format(o)}).catch(t=>{console.log(t)}).finally(()=>{})}}},N=n(2),D=n.n(N),P=function(t){let e=q(),n={},i={root:{},init:function(){},render:function(){var t;return this.root=e.render(),n=a.build("div",D.a,"firstElementChild"),this.root.appendChild((t=n,f.addEventListeners(t,{}),t)),this.root},mounted:function(){!function(e){t.publish("msg\\page_component\\update\\title","Strava Auth");let n=t.router.current.queryValues;if(n.error)return o("Error",n.error,!0);if(!n.code)return o("Error","Parámetros insuficientes: code",!0);if(z.config.access_token)return void t.router.navigateTo("");o("Autorizando...","Espera un momento mientras se completa el proceso de autorización. Esto puede tardar un poco.");const i="https://www.strava.com/oauth/token?client_id=44665&client_secret=e872f05ea832f409ffe0e1ce042b074f691718d3&code="+n.code+"&grant_type=authorization_code";a.ajax.post(i,"",t=>{t.setRequestHeader("Accept","application/javascript")}).then(t=>{let e=JSON.parse(t);if(e.errors)throw new Error("{resource}: {field} {code}".format(e.errors[0]));return e}).then(e=>{localStorage.setItem("strava",JSON.stringify(e)),z.reloadConfig(),o("Autorización","La autorización se ha completado correctamente"),setTimeout((function(){t.router.navigateTo("strava?ref=auth")}),2e3)}).catch(t=>{o("Error","No se ha podido obtener el token de acceso.{0}{0}{message}".format("<br/>",t),!0)})}()}};function o(e,o,r){if(n.innerHTML='\n      <div class= "w3-container w3-padding">\n        <h2>{0}</h2>\n        <p>{1}</p>\n      <div>'.format(e,o),r){a.$("button[on-click]",i.root)[0].onclick=()=>t.router.navigateTo("")}}return i},V=n(3),R=n.n(V),B=function(t){let e,i=q(),o={},r=1;function s(t){let e=n(5),i=a.build("div",e,!0),o={athlete:z.athlete,activities:t.map(t=>(t.total_photo_count&&(t.fotos=" ".repeat(t.total_photo_count).split("").map((e,n)=>"img-{0}-{1}".format(t.id,n))),t)),fn:{toKilometers:t=>(t/1e3).toLocaleString("es",{maximumFractionDigits:2}),formatSpeed:t=>(3.6*t).toLocaleString("es",{maximumFractionDigits:2}),formatTime:t=>t.fixTime("T").replace("Z",""),formatDuration:t=>{let e=Math.floor(t/60/60),n=Math.floor(t/60)%60,i=Math.floor(t-60*n)%3600,a=["{0}h ".format(e),"{0}min".format(n),"{0}s".format(i)];return e&&n?[a[0],a[1]].join(" "):e&&i?[a[0],a[2]].join(" "):n&&i?[a[1],a[2]].join(" "):n?a[1]:a[0]},formatDate:t=>{let e=(new Date).format(),n=t.fixDate("T").split("-").reverse().join("/");return e==n?"Hoy":n},showIf:(t,e,n)=>{(t===window?"":t)||(e.style.display="none")},showIfGreather:(t,e,n)=>{~~(t===window?0:t)<=~~e&&(n.style.display="none")},formatId:(t,e,n)=>"{0}-{1}".format(e,t),xif:(t,e,n,i)=>{let a=t===window?"":t;if(1==arguments.length)return void(a||(e.style.display="none"));let o=e===window?"":e,r=new Function("a","b","return {0};".format(n));i.style.display=r(a,o)?"":"none"}}};a.templates.fill(i,o),l(i);let s=a.$("load-more-mark");a.toArray(i.childNodes).forEach(t=>{3!=t.nodeType&&s.insertAdjacentElement("beforebegin",t)}),r++}function l(n){let i=a.$("[activity]",n),o=a.$("[act-desc]",n).toDictionary("id"),l=a.$("img[xfor]",n).toDictionary("id"),c=a.$("[act-map-img]",n).toDictionary("id"),d=a.$("load-more-mark");t.unsubscribe(e),e=t.subscribe("msg\\activities\\scroll",(e,n)=>{!function(e,n){if(""==n.loadMark.innerHTML&&n.loadMark.offsetTop<e+750)return n.loadMark.innerHTML="Cargando...",void z.loadActivities({page:r,rows:5}).then(t=>{s(t)}).catch(e=>{t.publish(t.topics.NOTIFICATION,{message:e.message})});n.bookmarks.where(t=>t.offsetTop-500<e&&!t.loaded).map(t=>{t.loaded=!0;let e=t.id.split("-")[1];z.loadActivity(e).then(t=>{if(t.description){let e="desc-{0}".format(t.id);n.descriptions[e].innerHTML=t.description||""}if(t.total_photo_count){let e="img-{0}-{1}".format(t.id,0);n.photos[e].src=t.photos.primary.urls[100]}if(t.map.polyline){let e=z.GOOGLE_STATIC_MAP.format(t),i="map-{0}".format(t.id);n.maps[i].appendChild(a.build("img",{src:e,className:"w3-border",style:{width:"100%"}}))}return z.loadActivityStream(t.id)}).then(t=>{})})}(n.scrollTop,{bookmarks:i,descriptions:o,photos:l,maps:c,loadMark:d})}),d.innerHTML="",t.publish("msg\\activities\\scroll",{scrollTop:100})}return{root:{},init:function(){},render:function(){return this.root=i.render(),o=a.build("div",R.a,"firstElementChild"),this.root.appendChild(o),this.root},mounted:function(){!function(){if(!z.config.token_type)return t.publish("msg\\page_component\\update\\title","Strava - Autorización"),o.innerHTML='\n      <div class= "w3-container w3-padding">\n        <h2>Autorización</h2>\n        <p style="text-indent:1em;">\n          Antes de continuar debes conceder permisos a la aplicación para acceder a tus datos en <span class="w3-bold w3-italic">Strava</span>.\n        </p>\n        <p style="text-indent:1em;">\n          El proceso de autorización es <span class="w3-bold w3-italic">seguro y se realiza en la web de Strava</span>.\n          Este permiso puede ser revocado si lo estimas oportuno.\n        </p>\n        <div class="w3-container w3-margin-bottom w3-center">\n          <button type="button" on-click="doAuth" class="w3-button w3-black">Autorizar</button>\n          <button type="button" on-click="goHome" class="w3-button w3-black">Cancelar</button>\n        </div>\n      <div>',void f.addEventListeners(o,{doAuth:()=>z.redirectToAuthPage(),goHome:()=>t.router.navigateTo("")});t.publish("msg\\page_component\\update\\title","Strava - Actividades"),i.addButton(a.build("button",{className:"pol-btn w3-button w3-black w3-right",innerHTML:'<i class="fa fa-calendar"></i>',onclick:()=>t.router.navigateTo("schedule")})),o.innerHTML='<div class= "w3-container w3-padding w3.center">  <h2>Cargando actividades...</h2><div>',z.loadAthleteInfo().then(t=>z.loadActivities({page:r,rows:5})).then(e=>{o.innerHTML='<div activity-container>\t<div id="load-more-mark" class="w3-container w3-round w3-margin w3-teal w3-center" style="min-height:2px"></div></div',o.onscroll=()=>t.publish("msg\\activities\\scroll",o),s(e)}).catch(t=>{o.innerHTML='<div class= "w3-container w3-padding">  <h2>Error</h2>  <p>{message}</p><div>'.format(t)})}()},dispose:function(){r=1,t.unsubscribe(e),localStorage.setItem("strava_cache",JSON.stringify(z.cache))}}};let z=function(){const t="https://www.strava.com/api/v3/";return{config:JSON.parse(localStorage.getItem("strava")||"{}"),athlete:void 0,redirectToAuthPage:function(){window.location="https://www.strava.com/oauth/authorize?client_id=44665&response_type=code&"+"redirect_uri={0}&".format("https://rcastrogo.github.io/notas-app/strava/exchange_token")+"approval_prompt=force&scope=read,activity:read_all"},reloadConfig:function(){this.config=JSON.parse(localStorage.getItem("strava")||"{}")},cache:{activities:{},streams:{},zones:{}},loadActivity:function n(i){if(z.cache.activities[i])return new Promise((t,e)=>{console.log("Cached activity info...",i),t(z.cache.activities[i])});return new Promise((o,r)=>{let s,l="{0}activities/{1}?access_token={access_token}".format(t,i,z.config);a.ajax.get(l,t=>{s=t,t.setRequestHeader("Accept","application/javascript")}).then(t=>{if(401==s.status)throw new Error("Authorization Error");return JSON.parse(t)}).then(t=>{console.log("Api call: activities/{0}".format(i)),z.cache.activities[t.id]=t,o(t)}).catch(t=>{401!=s.status?r(t):e(n).then(t=>{z.cache.activities[t.id]=t,o(t)})})})},loadActivityStream:function n(i){if(z.cache.streams[i])return new Promise((t,e)=>{console.log("Cached activity stream...",i),t(z.cache.streams[i])});return new Promise((o,r)=>{let s,l="{0}activities/{1}/streams?access_token={access_token}&keys={2}&key_by_type=true".format(t,i,"heartrate,altitude,watt,cadence,velocity_smooth",z.config);a.ajax.get(l,t=>{s=t,t.setRequestHeader("Accept","application/javascript")}).then(t=>{if(401==s.status)throw new Error("Authorization Error");return JSON.parse(t)}).then(t=>{console.log("Api call: activities/{0}/streams".format(i)),z.cache.streams[i]=t,o(t)}).catch(t=>{401!=s.status?r(t):e(n).then(t=>{z.cache.streams[t.id]=t,o(t)})})})},loadActivities:function n(i){return new Promise((o,r)=>{let s,l="{0}athlete/activities?access_token={access_token}&page={1}&per_page={2}".format(t,i.page,i.rows,z.config);a.ajax.get(l,t=>{s=t,t.setRequestHeader("Accept","application/javascript")}).then(t=>{if(401==s.status)throw new Error("Authorization Error");return JSON.parse(t)}).then(t=>{console.log("Api call: activities/page:{page}/rows:{rows}".format(i)),o(t)}).catch(t=>{401!=s.status?r(t):e(n,filter).then(t=>{o(t)})})})},loadAthleteInfo:function n(){if(z.athlete)return new Promise((t,e)=>{console.log("Cached athlete info...",z.athlete.id),t(z.athlete)});return new Promise((i,o)=>{let r,s="{0}athletes/{athlete.id}?access_token={access_token}".format(t,z.config);a.ajax.get(s,t=>{r=t,t.setRequestHeader("Accept","application/javascript")}).then(t=>{if(401==r.status)throw new Error("Authorization Error");return JSON.parse(t)}).then(t=>{console.log("Api call: athletes/{id}".format(t)),z.athlete=t,i(t)}).catch(t=>{401!=r.status?o(t):e(n).then(t=>{z.athlete=t,i(t)})})})},GOOGLE_STATIC_MAP:"https://maps.googleapis.com/maps/api/staticmap?visible={start_latlng[0]},{start_latlng[1]}&size=340x100&key=AIzaSyD-FEw7obgz5yH2a1OO84Xm1XzGoWFuWas&path=color:0x0000ff80|weight:2|enc:{map.polyline}"};function e(t,e){return new Promise((n,i)=>{const o="{0}?client_id=44665&client_secret=e872f05ea832f409ffe0e1ce042b074f691718d3&refresh_token={refresh_token}&grant_type=refresh_token".format("https://www.strava.com/oauth/token",z.config);let r;a.ajax.post(o,"",t=>{r=t,t.setRequestHeader("Accept","application/javascript")}).then(t=>{if(401==r.status)throw new Error("Authorization Error");return JSON.parse(t)}).then(i=>{s.publish(s.TOPICS.NOTIFICATION,{message:"Se ha renovado el token de acceso"}),z.config.access_token=i.access_token,z.config.expires_at=i.expires_at,z.config.expires_in=i.expires_in,z.config.refresh_token=i.refresh_token,localStorage.setItem("strava",JSON.stringify(z.config)),t?t(e).then(t=>n(t)):n()}).catch(t=>{i(t)})})}}();var F=n(4),$=n.n(F),G=function(t){let e,i,o=q(),r={},s=JSON.parse(localStorage.getItem("strava_cache"));function l(t,e){let n=t.FirstDate.format("yyyymmdd"),o=t.LastDate.format("yyyymmdd");i=Object.keys(s.activities).map(t=>{let e=s.activities[t];return{fechaUS:e.start_date.fixDate("T").replaceAll("-","/"),id:e.id}}).where(t=>n<=t.fechaUS&&o>=t.fechaUS),t.ClearMonthView(),t.LoadMonthView(i.reduce((function(e,n){let i=n.fechaUS.split("/").reverse().join("/"),o=a.build("div",{innerHTML:'<i class="fa fa-bicycle"></i>',className:"w3-badge w3-red w3-display-middle w3-large",id:"activity_{0}".format(i),onclick:function(){t.ShowDayView(this.id.split("_")[1]),t.Buttons.Agenda.click()}});return e[i]=[],e[i].push(o),e}),{})),c(t,t.Date)}function c(t,e){t.ClearDayView(),t.ClearAgendaView();let o=e.format("yyyymmdd"),r=n(6);t.LoadDayView((()=>{let e=-50;return[...Array(24).keys()].reduce((n,i,o)=>{if(100*Math.random()<80)return n;if(o>29)return n;let s={hora:o.toString(),dimension:a.apply({top:"{0}px".format(e+=60)},t.MeasureDayItem({start:60*o,end:60*o+360}))},l=a.build("div",r.format(s),!0);return n.push(l),n},[])})());let l=n(7),c=a.build("div",l,!0),d={athlete:z.athlete,activities:i.where(t=>t.fechaUS==o).map(t=>s.activities[t.id]),fn:{toKilometers:t=>(t/1e3).toLocaleString("es",{maximumFractionDigits:2}),formatSpeed:t=>(3.6*t).toLocaleString("es",{maximumFractionDigits:2}),formatTime:t=>t.fixTime("T").replace("Z",""),formatDuration:t=>{let e=Math.floor(t/60/60),n=Math.floor(t/60)%60,i=Math.floor(t-60*n)%3600,a=["{0}h ".format(e),"{0}min".format(n),"{0}s".format(i)];return e&&n?[a[0],a[1]].join(" "):e&&i?[a[0],a[2]].join(" "):n&&i?[a[1],a[2]].join(" "):n?a[1]:a[0]},formatDate:t=>{let e=(new Date).format(),n=t.fixDate("T").split("-").reverse().join("/");return e==n?"Hoy":n},showIf:(t,e,n)=>{(t===window?"":t)||(e.style.display="none")},showIfGreather:(t,e,n)=>{~~(t===window?0:t)<=~~e&&(n.style.display="none")},formatId:(t,e,n)=>"{0}-{1}".format(e,t)}};t.LoadAgendaView(a.toArray(a.templates.fill(c,d).childNodes).where(t=>3!=t.nodeType).map(t=>{let e=a.$("img[act-img]",t)[0],n=e.id.split("-")[1],i=s.activities[n];return i.map.polyline&&(e.src=z.GOOGLE_STATIC_MAP.format(i)),t}))}return{root:{},init:function(){},render:function(){var t;return this.root=o.render(),r=a.build("div",$.a,"firstElementChild"),this.root.appendChild((t=r,f.addEventListeners(t,{}),t)),this.root},mounted:function(){t.publish("msg\\page_component\\update\\title",""),z.loadAthleteInfo().then(()=>{a.Include("./assets/js/schedule.js").then(()=>{e=Schedule({Element:r,View:"Month",OnMonthChanged:l,OnDayChanged:c}),o.addButton(e.Buttons.Day),o.addButton(e.Buttons.Agenda),o.addButton(e.Buttons.Month)})})}}};const W=s.TOPICS,J={root:a.$("appContent"),components:[],router:{routes:[],addRoute:function(t,e,n,i){return this.routes.push({name:t,path:e,controler:n,isView:i||!1}),this},getRoute:function(t){return this.routes.where((function(e){let n=e.path.exec(t);return n&&(e.params=n.map(t=>t)),n}))[0]},navigateTo:function(t){this.current=this.getRoute(t);let e="{origin}{0}{1}".format(APP_PATH,t,location);window.history.pushState("",t,e),this.current.queryValues=a.parseQueryString(),X()},normalizePath:function(t){return t.replace(document.baseURI,"")},sync:function(){this.current=this.getRoute(this.normalizePath(window.location.href)),this.current.queryValues=a.parseQueryString(),X()},current:{}},topics:s.TOPICS,publish:s.publish,subscribe:s.subscribe,unsubscribe:s.unsubscribe};J.components=[{root:{},title:"Notas App",init:function(){},render:function(){let t={id:"appHeader",innerHTML:l.format(this),className:"w3-container w3-teal"};return this.root=a.build("header",t),this.root},mounted:function(){}},h(J),u(),{text:"© Rafael Castro Gómez, 2020",init:function(){},render:function(){let t={id:"appFooter",innerHTML:c.format(this),className:"w3-container w3-teal w3-center"};return a.build("footer",t)},mounted:function(){}}],J.router.addRoute("list",/list$/,g).addRoute("about",/about$/,y).addRoute("note",/note$/,k).addRoute("note",/note\/(\d{13})$/,k).addRoute("el-tiempo",/el-tiempo$/,E).addRoute("templates",/templates$/,_).addRoute("get-value",/templates\/get-value$/,T).addRoute("utils",/templates\/utils$/,C).addRoute("images",/images\/(\d+)$/,j,!0).addRoute("schedule",/schedule$/,G,!0).addRoute("strava-exchange-token",/strava\/exchange_token/,P,!0).addRoute("strava-main",/strava[?]?(.*)$/,B,!0).addRoute("",/$/,v),J.components.forEach(t=>{t.init&&t.init(),J.root.appendChild(t.render()),t.mounted&&t.mounted()}),s.subscribe(W.VIEW_CHANGE,(t,e)=>{let n=J.components[0].root.style,i=J.components[1].root,a=J.components[2].root.style;e.isView?(i.classList.remove("sticky"),i.style.display="none",a.position="absolute",a.paddingBottom="0",a.left="0",a.right="0",a.bottom="52px",a.top="74px",a.overflow="auto",n.position="fixed",n.width="100%",n.zIndex="1000"):(i.style.display="",a.position="",a.paddingBottom="60px",a.overflow="",n.position="",n.width="",n.zIndex="")}),function(){let t=a.build("div",{id:"notificationPanel"});J.root.parentNode.insertBefore(t,J.root),s.subscribe(W.WINDOW_SCROLL,(e,n)=>{n.pageYOffset>=40?t.classList.add("sticky"):t.classList.remove("sticky")}),s.subscribe(W.NOTIFICATION,(function(e,n){let i='<div class="msg w3-container w3-border w3-round w3-animate-top">\n                        <span on-click="close" class="w3-button w3-large w3-display-right">x</span>\n                        <p style="overflow:hidden;margin-right:27px;">{message}</p>\n                      </div>',o=a.build("div",i.format(n)).firstElementChild;t.appendChild(o),f.addEventListeners(o,{close:e=>{o.classList.remove("w3-animate-top"),o.style.backgroundColor="gray",o.style.color="white",o.style.opacity="0",o.style.transform="translate(0, -200px)",setTimeout(()=>{o.parentNode&&t.removeChild(o)},500)}})}))}();const U=a.$("app-content-container");let Z,Y;function X(){let t=J.router.current.controler;Y&&Z==t||(Y&&Y.dispose&&Y.dispose(),U.innerHTML="",Y=t(J),Z=t,Y.init&&Y.init(),U.appendChild(Y.render()),Y.mounted&&Y.mounted(),s.publish(W.VIEW_CHANGE,J.router.current))}J.router.sync(),window.onpopstate=function(t){J.router.sync()},window.addEventListener("load",()=>{if("serviceWorker"in navigator)try{navigator.serviceWorker.register("serviceWorker.js"),console.log("Service Worker Registered")}catch(t){console.log("Service Worker Registration Failed")}})}]);